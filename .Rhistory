subtitle = "Production ",
caption = tt_caption)
fishing %>%
filter(!is.na(values),
str_detect(region, "U.S. Total")) %>%
group_by(year, lake) %>%
summarize(lbs_total = 1000 * sum(values, na.rm = TRUE)) %>%
ggplot(aes(year, lbs_total, color = lake)) +
geom_point(alpha = 0.05) +
geom_smooth(method = "loess", se = FALSE) +
scale_y_continuous(labels = comma) +
#facet_wrap(~lake) +
labs(x = "",
y = "# of pounds",
color = "Lake",
title = "Commercial Fishing",
subtitle = "Production from Lake Michigan peaked in the 1970's before dropping since",
caption = tt_caption)
fishing %>%
filter(!is.na(values),
str_detect(region, "U.S. Total")) %>%
group_by(year, lake) %>%
summarize(lbs_total = 1000 * sum(values, na.rm = TRUE)) %>%
ggplot(aes(year, lbs_total, color = lake)) +
geom_point(alpha = 0.05) +
geom_smooth(method = "loess", se = FALSE) +
scale_y_continuous(labels = comma) +
#facet_wrap(~lake) +
labs(x = "",
y = "# of pounds",
color = "Lake",
title = "Commercial Fishing",
subtitle = "Production from Lake Michigan peaked in the 1970's before dropping",
caption = tt_caption)
fishing %>%
filter(!is.na(values),
region == "U.S. Total") %>%
mutate(species = fct_lump(species, 9),
lbs_total = 1000 * values) %>%
filter(species != "Other") %>%
ggplot(aes(year, lbs_total, color = species)) +
geom_point(alpha = 0.05) +
geom_smooth(method = "loess", se = FALSE) +
scale_y_log10(labels = comma) +
facet_wrap(~species) +
theme(legend.position = "none") +
labs(x = "",
y = "# of pounds",
color = "Species",
title = "Commercial Fishing: Top 9 species by production",
subtitle = "Lake Trout and Lake Whitefish are the only ones increasing",
caption = tt_caption)
# This will save your most recent plot
ggsave(
filename = "2021_06_08_tidy_tuesday.png",
device = "png")
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(tidytuesdayR)
library(scales)
#install.packages("survivoR")
library(survivoR)
theme_set(theme_light())
tt_caption <- "Source: survivoR Package  |  Analysis: Tony Galvan (@GDataScience1)"
#tt <- tt_load("2021-06-01")
#tt
#tt %>%
#  map(glimpse)
#season_summary <- survivoR::season_summary
#castaways <- survivoR::castaways
season_summary %>%
select(season,
viewers_premier,
viewers_finale,
viewers_reunion,
viewers_mean) %>%
pivot_longer(cols = -season,
names_to = "episode",
values_to = "viewers") %>%
mutate(episode = str_replace(episode, "viewers_", ""),
episode = str_to_title(episode),
episode = fct_relevel(episode, "Mean"),
episode = fct_relevel(episode, "Premier")) %>%
ggplot(aes(x = season, y = viewers, color = episode)) +
geom_line() +
labs(
title = "Survivor viewers over the 40 seasons",
x = "Season",
y = "Viewers (Millions)",
color = "",
caption = "Source: survivoR Package  |  Code: github.com/doehm/survivoR"
)
season_summary %>%
mutate(country = fct_lump(country, 8)) %>%
count(country, sort = TRUE) %>%
mutate(country = fct_reorder(country, n)) %>%
ggplot(aes(n, country, fill = country)) +
geom_col(show.legend = FALSE)
season_summary %>%
select(season,
filming_started,
filming_ended,
airing_started = premiered,
airing_ended = ended) %>%
pivot_longer(cols = -season,
names_to = "date_type",
values_to = "date") %>%
separate(date_type, into = c("film_air", "start_end"), sep = "_") %>%
pivot_wider(names_from = "start_end", values_from = "date") %>%
ggplot() +
geom_errorbar(aes(x = season,
ymin = started,
ymax = ended,
color = film_air)) +
coord_flip() +
labs(
title = "Survivor film/air dates over the 40 seasons",
x = "",
y = "Season",
color = "",
caption = tt_caption
)
season_summary %>%
mutate(time_to_air = premiered - filming_ended) %>%
ggplot(aes(season, time_to_air)) +
geom_point(alpha = 0.25) +
geom_smooth(method = "loess", se = FALSE) +
expand_limits(y = 0) +
labs(
title = "Survivor days to air over the 40 seasons",
subtitle = "Production time increased in the last 20 seasons",
x = "Season",
y = "Days between the end of filming and the premier",
caption = tt_caption
)
castaways %>%
group_by(season) %>%
summarize(avg_age = mean(age)) %>%
ggplot(aes(season, avg_age)) +
geom_point(alpha = 0.25) +
geom_smooth(method = "loess", se = FALSE) +
labs(
title = "Survivor castaway ages over the 40 seasons",
#subtitle = "Production time increased in the last 20 seasons",
x = "Season",
y = "Average age",
caption = tt_caption
)
castaways %>%
ggplot(aes(season, age, fill = factor(season), group = season)) +
geom_boxplot(show.legend = FALSE) +
annotate(geom = "text",
x = 8,
y = 75,
size = 3,
hjust = -0.03,
color = "red",
label = "Rudy Boesch: 75 (Season 8)") +
annotate(geom = "text",
x = 1,
y = 72,
size = 3,
hjust = -0.03,
color = "red",
label = "Rudy Boesch: 72 (Season 1)") +
labs(
title = "Survivor castaway ages over the 40 seasons",
subtitle = "Rudy Boesch was the oldest and 2nd oldest Survivor",
x = "Season",
y = "Age",
caption = tt_caption
)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(tidytuesdayR)
library(scales)
#install.packages("survivoR")
library(survivoR)
theme_set(theme_light())
tt_caption <- "Source: survivoR Package  |  Analysis: Tony Galvan (@GDataScience1)"
#tt <- tt_load("2021-06-01")
#tt
#tt %>%
#  map(glimpse)
#season_summary <- survivoR::season_summary
#castaways <- survivoR::castaways
season_summary %>%
select(season,
viewers_premier,
viewers_finale,
viewers_reunion,
viewers_mean) %>%
pivot_longer(cols = -season,
names_to = "episode",
values_to = "viewers") %>%
mutate(episode = str_replace(episode, "viewers_", ""),
episode = str_to_title(episode),
episode = fct_relevel(episode, "Mean"),
episode = fct_relevel(episode, "Premier")) %>%
ggplot(aes(x = season, y = viewers, color = episode)) +
geom_line() +
labs(
title = "Survivor viewers over the 40 seasons",
x = "Season",
y = "Viewers (Millions)",
color = "",
caption = "Source: survivoR Package  |  Code: github.com/doehm/survivoR"
)
season_summary %>%
mutate(country = fct_lump(country, 8)) %>%
count(country, sort = TRUE) %>%
mutate(country = fct_reorder(country, n)) %>%
ggplot(aes(n, country, fill = country)) +
geom_col(show.legend = FALSE)
season_summary %>%
select(season,
filming_started,
filming_ended,
airing_started = premiered,
airing_ended = ended) %>%
pivot_longer(cols = -season,
names_to = "date_type",
values_to = "date") %>%
separate(date_type, into = c("film_air", "start_end"), sep = "_") %>%
pivot_wider(names_from = "start_end", values_from = "date") %>%
ggplot() +
geom_errorbar(aes(x = season,
ymin = started,
ymax = ended,
color = film_air)) +
coord_flip() +
labs(
title = "Survivor film/air dates over the 40 seasons",
x = "",
y = "Season",
color = "",
caption = tt_caption
)
season_summary %>%
mutate(time_to_air = premiered - filming_ended) %>%
ggplot(aes(season, time_to_air)) +
geom_point(alpha = 0.25) +
geom_smooth(method = "loess", se = FALSE) +
expand_limits(y = 0) +
labs(
title = "Survivor days to air over the 40 seasons",
subtitle = "Production time increased in the last 20 seasons",
x = "Season",
y = "Days between the end of filming and the premier",
caption = tt_caption
)
castaways %>%
group_by(season) %>%
summarize(avg_age = mean(age)) %>%
ggplot(aes(season, avg_age)) +
geom_point(alpha = 0.25) +
geom_smooth(method = "loess", se = FALSE) +
labs(
title = "Survivor castaway ages over the 40 seasons",
#subtitle = "Production time increased in the last 20 seasons",
x = "Season",
y = "Average age",
caption = tt_caption
)
castaways %>%
ggplot(aes(season, age, fill = factor(season), group = season)) +
geom_boxplot(show.legend = FALSE) +
annotate(geom = "text",
x = 8,
y = 75,
size = 3,
hjust = -0.03,
color = "red",
label = "Rudy Boesch: 75 (Season 8)") +
annotate(geom = "text",
x = 1,
y = 72,
size = 3,
hjust = -0.03,
color = "red",
label = "Rudy Boesch: 72 (Season 1)") +
labs(
title = "Survivor castaway ages over the 40 seasons",
subtitle = "Rudy Boesch was the oldest and 2nd oldest Survivor",
x = "Season",
y = "Age",
caption = tt_caption
)
season_summary
season_summary %>%
select(season,
filming_started,
filming_ended,
airing_started = premiered,
airing_ended = ended) %>%
pivot_longer(cols = -season,
names_to = "date_type",
values_to = "date")
season_summary %>%
select(season,
filming_started,
filming_ended,
airing_started = premiered,
airing_ended = ended) %>%
pivot_longer(cols = -season,
names_to = "date_type",
values_to = "date") %>%
separate(date_type, into = c("film_air", "start_end"), sep = "_")
season_summary %>%
select(season,
filming_started,
filming_ended,
airing_started = premiered,
airing_ended = ended) %>%
pivot_longer(cols = -season,
names_to = "date_type",
values_to = "date") %>%
separate(date_type, into = c("film_air", "start_end"), sep = "_") %>%
pivot_wider(names_from = "start_end", values_from = "date")
season_summary %>%
select(season,
filming_started,
filming_ended,
airing_started = premiered,
airing_ended = ended) %>%
pivot_longer(cols = -season,
names_to = "date_type",
values_to = "date") %>%
separate(date_type, into = c("film_air", "start_end"), sep = "_") %>%
pivot_wider(names_from = "start_end", values_from = "date") %>%
ggplot() +
geom_errorbar(aes(x = season,
ymin = started,
ymax = ended,
color = film_air)) +
coord_flip() +
labs(
title = "Survivor film/air dates over the 40 seasons",
x = "",
y = "Season",
color = "",
caption = tt_caption
)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(tidytuesdayR)
library(scales)
theme_set(theme_light())
tt_caption <- "Source: Great Lakes Database  |  Analysis: Tony Galvan (@GDataScience1)"
tt <- tt_load("2021-06-08")
tt
tt %>%
map(glimpse)
fishing <- tt$fishing
stocked <- stocked <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-06-08/stocked.csv') %>%
janitor::clean_names()
fishing %>%
filter(!is.na(values),
region == "U.S. Total") %>%
group_by(year) %>%
summarize(lbs_total = 1000 * sum(values, na.rm = TRUE)) %>%
ggplot(aes(year, lbs_total)) +
geom_point(alpha = 0.25) +
geom_smooth(method = "loess", se = FALSE) +
scale_y_continuous(labels = comma) +
labs(x = "",
y = "# of pounds",
title = "Commercial Fishing",
subtitle = "Production amounts have been going down since the 1930's",
caption = tt_caption)
fishing %>%
filter(!is.na(values),
region != "U.S. Total") %>%
group_by(year, region) %>%
summarize(lbs_total = 1000 * sum(values, na.rm = TRUE)) %>%
ggplot(aes(year, lbs_total)) +
geom_point(alpha = 0.25) +
geom_smooth(method = "loess", se = FALSE) +
scale_y_continuous(labels = comma) +
facet_wrap(~region) +
labs(x = "",
y = "# of pounds",
title = "Commercial Fishing",
subtitle = "Production amounts have been going down since the 1930's",
caption = tt_caption)
fishing %>%
filter(!is.na(values),
region == "U.S. Total") %>%
mutate(species = fct_lump(species, 9),
lbs_total = 1000 * values) %>%
filter(species != "Other") %>%
ggplot(aes(year, lbs_total, color = species)) +
geom_point(alpha = 0.05) +
geom_smooth(method = "loess", se = FALSE) +
scale_y_log10(labels = comma) +
facet_wrap(~species) +
theme(legend.position = "none") +
labs(x = "",
y = "# of pounds",
color = "Species",
title = "Commercial Fishing: Top 9 species by production",
subtitle = "Lake Trout and Lake Whitefish are the only ones increasing",
caption = tt_caption)
fishing %>%
filter(!is.na(values),
str_detect(region, "U.S. Total")) %>%
group_by(year, lake) %>%
summarize(lbs_total = 1000 * sum(values, na.rm = TRUE)) %>%
ggplot(aes(year, lbs_total, color = lake)) +
geom_point(alpha = 0.05) +
geom_smooth(method = "loess", se = FALSE) +
scale_y_continuous(labels = comma) +
#facet_wrap(~lake) +
labs(x = "",
y = "# of pounds",
color = "Lake",
title = "Commercial Fishing",
subtitle = "Production from Lake Michigan peaked in the 1970's before dropping",
caption = tt_caption)
stocked %>%
group_by(year) %>%
summarize(lbs_total = 2.2 * sum(weight, na.rm = TRUE)) %>%
ggplot(aes(year, lbs_total)) +
geom_point(alpha = 0.25) +
geom_smooth(method = "loess", se = FALSE) +
scale_y_continuous(labels = comma) +
labs(x = "",
y = "# of pounds",
title = "Commercial Fish Stocking",
subtitle = "Heavier weight of stocked fish since the late 1980's",
caption = tt_caption)
fishing %>%
count(region, sort = true)
fishing %>%
count(region, sort = TRUE)
fishing %>%
filter(!is.na(values),
str_detect(region, "Canada (ONT)")) %>%
group_by(year, lake) %>%
summarize(lbs_total = 1000 * sum(values, na.rm = TRUE)) %>%
ggplot(aes(year, lbs_total, color = lake)) +
geom_point(alpha = 0.05) +
geom_smooth(method = "loess", se = FALSE) +
scale_y_continuous(labels = comma) +
#facet_wrap(~lake) +
labs(x = "",
y = "# of pounds",
color = "Lake",
title = "Canadian Commercial Fishing",
subtitle = "Production from Lake Michigan peaked in the 1970's before dropping",
caption = tt_caption)
fishing %>%
filter(!is.na(values),
region == "Canada (ONT)") %>%
group_by(year, lake) %>%
summarize(lbs_total = 1000 * sum(values, na.rm = TRUE)) %>%
ggplot(aes(year, lbs_total, color = lake)) +
geom_point(alpha = 0.05) +
geom_smooth(method = "loess", se = FALSE) +
scale_y_continuous(labels = comma) +
#facet_wrap(~lake) +
labs(x = "",
y = "# of pounds",
color = "Lake",
title = "Canadian Commercial Fishing",
subtitle = "Production from Lake Michigan peaked in the 1970's before dropping",
caption = tt_caption)
fishing %>%
filter(!is.na(values),
region == "Canada (ONT)") %>%
group_by(year, lake) %>%
summarize(lbs_total = 1000 * sum(values, na.rm = TRUE)) %>%
ggplot(aes(year, lbs_total, color = lake)) +
geom_point(alpha = 0.05) +
geom_smooth(method = "loess", se = FALSE) +
scale_y_log10(labels = comma) +
#facet_wrap(~lake) +
labs(x = "",
y = "# of pounds",
color = "Lake",
title = "Canadian Commercial Fishing",
subtitle = "Production from Lake Michigan peaked in the 1970's before dropping",
caption = tt_caption)
fishing %>%
filter(!is.na(values),
region == "Canada (ONT)") %>%
group_by(year, lake) %>%
summarize(lbs_total = 1000 * sum(values, na.rm = TRUE)) %>%
ggplot(aes(year, lbs_total, color = lake)) +
geom_point(alpha = 0.05) +
geom_smooth(method = "loess", se = FALSE) +
scale_y_log10(labels = comma) +
#facet_wrap(~lake) +
labs(x = "",
y = "# of pounds",
color = "Lake",
title = "Canadian Commercial Fishing",
subtitle = "TBD",
caption = tt_caption)
stocked
stocked %>%
group_by(year) %>%
summarize(lbs_total = 2.2 * sum(weight, na.rm = TRUE)) %>%
ggplot(aes(year, lbs_total)) +
geom_point(alpha = 0.25) +
geom_smooth(method = "loess", se = FALSE) +
scale_y_continuous(labels = comma) +
labs(x = "",
y = "# of pounds",
title = "Commercial Fish Stocking",
subtitle = "Heavier weight of stocked fish since the late 1980's",
caption = tt_caption)
