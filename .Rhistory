map(glimpse)
driver_results_df <- tt$driver_standings %>%
left_join(tt$races, by = "raceId") %>%
rename(driver_url = url) %>%
left_join(tt$drivers, by = "driverId")
glimpse(driver_results_df)
driver_results_df <- tt$driver_standings %>%
left_join(tt$races, by = "raceId") %>%
rename(driver_url = url) %>%
left_join(tt$drivers, by = "driverId")
glimpse(driver_results_df)
driver_results_df %>%
count(nationality, sort = TRUE)
summary(driver_results_df$date)
driver_results_df %>%
mutate(nationality = fct_lump(nationality, 10)) %>%
count(nationality, sort = TRUE)
driver_results_df %>%
mutate(nationality = fct_lump(nationality, 8)) %>%
count(nationality, sort = TRUE)
driver_results_df %>%
mutate(nationality = fct_lump(nationality, 8)) %>%
group_by(year, nationality) %>%
summarize(year_points = sum(points))
driver_results_df %>%
mutate(nationality = fct_lump(nationality, 8)) %>%
group_by(year, nationality) %>%
summarize(year_points = sum(points)) %>%
ggplot(aes(year, year_points, color = nationality)) +
geom_line()
driver_results_df %>%
mutate(nationality = fct_lump(nationality, 8)) %>%
group_by(year, nationality) %>%
summarize(year_points = sum(points)) %>%
ggplot(aes(year, year_points, color = nationality)) +
geom_line() +
scale_y_log10()
driver_results_df %>%
mutate(nationality = fct_lump(nationality, 8)) %>%
group_by(year, nationality) %>%
summarize(year_points = sum(points)) %>%
ggplot(aes(year, year_points+1, color = nationality)) +
geom_line() +
scale_y_log10()
driver_results_df %>%
mutate(nationality = fct_lump(nationality, 8)) %>%
group_by(year, nationality) %>%
summarize(year_points = sum(points)) %>%
ggplot(aes(year, year_points, color = nationality)) +
geom_line() +
scale_y_log10()
driver_results_df %>%
mutate(nationality = fct_lump(nationality, 8)) %>%
group_by(year, nationality) %>%
summarize(year_points = sum(points)) %>%
ggplot(aes(year, year_points, color = nationality)) +
geom_line()
driver_results_df %>%
mutate(nationality = fct_lump(nationality, 8)) %>%
group_by(year, nationality) %>%
summarize(year_points = sum(points)) %>%
ggplot(aes(year, year_points, fill = nationality)) +
geom_col()
driver_results_df %>%
mutate(nationality = fct_lump(nationality, 8)) %>%
add_count(year, wt = points, name = "total_year_points") %>%
group_by(year, nationality, total_year_points) %>%
summarize(year_points = sum(points),
pct_points = year_points/total_year_points) %>%
ggplot(aes(year, pct_points, fill = nationality)) +
geom_col()
driver_results_df %>%
mutate(nationality = fct_lump(nationality, 8)) %>%
add_count(year, wt = points, name = "total_year_points") %>%
group_by(year, nationality, total_year_points) %>%
summarize(year_points = sum(points)) %>%
ungroup() %>%
mutate(pct_points = year_points/total_year_points) %>%
ggplot(aes(year, pct_points, fill = nationality)) +
geom_col()
driver_results_df %>%
mutate(nationality = fct_lump(nationality, 8)) %>%
add_count(year, wt = points, name = "total_year_points") %>%
group_by(year, nationality, total_year_points) %>%
summarize(year_points = sum(points)) %>%
ungroup() %>%
mutate(pct_points = year_points/total_year_points,
nationality = fct_reorder(pct_points)) %>%
ggplot(aes(year, pct_points, fill = nationality)) +
geom_col()
driver_results_df %>%
mutate(nationality = fct_lump(nationality, 8)) %>%
add_count(year, wt = points, name = "total_year_points") %>%
group_by(year, nationality, total_year_points) %>%
summarize(year_points = sum(points)) %>%
ungroup() %>%
mutate(pct_points = year_points/total_year_points,
nationality = fct_reorder(nationality, pct_points)) %>%
ggplot(aes(year, pct_points, fill = nationality)) +
geom_col()
driver_results_df %>%
mutate(nationality = fct_lump(nationality, 8)) %>%
add_count(year, wt = points, name = "total_year_points") %>%
group_by(year, nationality, total_year_points) %>%
summarize(year_points = sum(points)) %>%
ungroup() %>%
mutate(pct_points = year_points/total_year_points,
nationality = fct_reorder(nationality, pct_points)) %>%
ggplot(aes(year, pct_points, fill = nationality)) +
geom_area()
driver_results_df %>%
mutate(nationality = fct_lump(nationality, 8)) %>%
add_count(year, wt = points, name = "total_year_points") %>%
group_by(year, nationality, total_year_points) %>%
summarize(year_points = sum(points)) %>%
ungroup() %>%
mutate(pct_points = year_points/total_year_points,
nationality = fct_reorder(nationality, pct_points)) %>%
ggplot(aes(year, pct_points, fill = nationality)) +
geom_col() %>%
scale_y_continuous(labels = percent_format())
driver_results_df %>%
mutate(nationality = fct_lump(nationality, 8)) %>%
add_count(year, wt = points, name = "total_year_points") %>%
group_by(year, nationality, total_year_points) %>%
summarize(year_points = sum(points)) %>%
ungroup() %>%
mutate(pct_points = year_points/total_year_points,
nationality = fct_reorder(nationality, pct_points)) %>%
ggplot(aes(year, pct_points, fill = nationality)) +
geom_col() +
scale_y_continuous(labels = percent_format())
driver_results_df %>%
mutate(nationality = fct_lump(nationality, 8)) %>%
add_count(year, wt = points, name = "total_year_points") %>%
group_by(year, nationality, total_year_points) %>%
summarize(year_points = sum(points)) %>%
ungroup() %>%
mutate(pct_points = year_points/total_year_points,
nationality = fct_reorder(nationality, -pct_points)) %>%
ggplot(aes(year, pct_points, fill = nationality)) +
geom_col() +
scale_y_continuous(labels = percent_format())
driver_results_df %>%
mutate(nationality = fct_lump(nationality, 8)) %>%
add_count(year, wt = points, name = "total_year_points") %>%
group_by(year, nationality, total_year_points) %>%
summarize(year_points = sum(points)) %>%
ungroup() %>%
mutate(pct_points = year_points/total_year_points,
nationality = fct_reorder(nationality, -pct_points)) %>%
ggplot(aes(year, pct_points, color = nationality)) +
geom_line() +
scale_y_continuous(labels = percent_format()) +
facet_wrap(~nationality)
driver_results_df %>%
mutate(nationality = fct_lump(nationality, 8)) %>%
add_count(year, wt = points, name = "total_year_points") %>%
group_by(year, nationality, total_year_points) %>%
summarize(year_points = sum(points)) %>%
ungroup() %>%
mutate(pct_points = year_points/total_year_points,
nationality = fct_reorder(nationality, -pct_points)) %>%
ggplot(aes(year, pct_points, color = nationality)) +
geom_line(show.legend = FALSE) +
scale_y_continuous(labels = percent_format()) +
facet_wrap(~nationality)
driver_results_df %>%
mutate(nationality = fct_lump(nationality, 8)) %>%
add_count(year, wt = points, name = "total_year_points") %>%
group_by(year, nationality, total_year_points) %>%
summarize(year_points = sum(points)) %>%
ungroup() %>%
mutate(pct_points = year_points/total_year_points,
nationality = fct_reorder(nationality, -pct_points)) %>%
ggplot(aes(year, pct_points, color = nationality)) +
geom_line(show.legend = FALSE) +
scale_y_continuous(labels = percent_format()) +
facet_wrap(~nationality) +
labs(x = "",
y = "% of yearly points",
title = "Formula 1 National Results",
subtitle = "Top 8 Nationalities",
caption = tt_caption)
tt_caption <- "Source: Ergast API  |  Analysis: Tony Galvan (@GDataScience1)"
driver_results_df %>%
mutate(nationality = fct_lump(nationality, 8)) %>%
add_count(year, wt = points, name = "total_year_points") %>%
group_by(year, nationality, total_year_points) %>%
summarize(year_points = sum(points)) %>%
ungroup() %>%
mutate(pct_points = year_points/total_year_points,
nationality = fct_reorder(nationality, -pct_points)) %>%
ggplot(aes(year, pct_points, color = nationality)) +
geom_line(show.legend = FALSE) +
scale_y_continuous(labels = percent_format()) +
facet_wrap(~nationality) +
labs(x = "",
y = "% of yearly points",
title = "Formula 1 National Results",
subtitle = "Top 8 Nationalities",
caption = tt_caption)
driver_results_df %>%
mutate(nationality = fct_lump(nationality, 9)) %>%
filter(nationality != "Other") %>%
add_count(year, wt = points, name = "total_year_points") %>%
group_by(year, nationality, total_year_points) %>%
summarize(year_points = sum(points)) %>%
ungroup() %>%
mutate(pct_points = year_points/total_year_points,
nationality = fct_reorder(nationality, -pct_points)) %>%
ggplot(aes(year, pct_points, color = nationality)) +
geom_line(show.legend = FALSE) +
scale_y_continuous(labels = percent_format()) +
facet_wrap(~nationality) +
labs(x = "",
y = "% of yearly points",
title = "Formula 1 Race Results",
subtitle = "Top 8 Nationalities",
caption = tt_caption)
driver_results_df %>%
mutate(nationality = fct_lump(nationality, 9)) %>%
filter(nationality != "Other") %>%
add_count(year, wt = points, name = "total_year_points") %>%
group_by(year, nationality, total_year_points) %>%
summarize(year_points = sum(points)) %>%
ungroup() %>%
mutate(pct_points = year_points/total_year_points,
nationality = fct_reorder(nationality, -pct_points)) %>%
ggplot(aes(year, pct_points, color = nationality)) +
geom_line(show.legend = FALSE) +
scale_y_continuous(labels = percent_format()) +
facet_wrap(~nationality) +
labs(x = "",
y = "% of yearly points",
title = "Formula 1 Race Results",
subtitle = "Top 9 Nationalities",
caption = tt_caption)
driver_results_df %>%
mutate(nationality = fct_lump(nationality, 9)) %>%
filter(nationality != "Other") %>%
add_count(year, wt = points, name = "total_year_points") %>%
group_by(year, nationality, total_year_points) %>%
summarize(year_points = sum(points)) %>%
ungroup() %>%
mutate(pct_points = year_points/total_year_points,
nationality = fct_reorder(nationality, -pct_points)) %>%
ggplot(aes(year, pct_points, color = nationality)) +
geom_line(size = 1, show.legend = FALSE) +
scale_y_continuous(labels = percent_format()) +
facet_wrap(~nationality) +
labs(x = "",
y = "% of yearly points",
title = "Formula 1 Race Results",
subtitle = "Top 9 Nationalities",
caption = tt_caption)
driver_results_df %>%
mutate(nationality = fct_lump(nationality, 9)) %>%
filter(nationality != "Other") %>%
add_count(year, wt = points, name = "total_year_points") %>%
group_by(year, nationality, total_year_points) %>%
summarize(year_points = sum(points)) %>%
ungroup() %>%
mutate(pct_points = year_points/total_year_points,
nationality = fct_reorder(nationality, -pct_points)) %>%
ggplot(aes(year, pct_points, color = nationality)) +
geom_line(show.legend = FALSE) +
scale_y_continuous(labels = percent_format()) +
facet_wrap(~nationality) +
labs(x = "",
y = "% of yearly points",
title = "Formula 1 Race Results",
subtitle = "Top 9 Nationalities",
caption = tt_caption)
driver_results_df %>%
mutate(nationality = fct_lump(nationality, 9)) %>%
filter(nationality != "Other") %>%
add_count(year, wt = points, name = "total_year_points") %>%
group_by(year, nationality, total_year_points) %>%
summarize(year_points = sum(points)) %>%
ungroup() %>%
mutate(pct_points = year_points/total_year_points,
nationality = fct_reorder(nationality, -pct_points)) %>%
ggplot(aes(year, pct_points, color = nationality)) +
geom_line(show.legend = FALSE) +
scale_y_continuous(labels = percent_format()) +
facet_wrap(~nationality) +
labs(x = "",
y = "% of yearly points",
title = "Formula 1 Races",
subtitle = "Top 9 Nationalities by Percentage of Yearly Points",
caption = tt_caption)
# This will save your most recent plot
ggsave(
filename = "2021_09_07_tidy_tuesday.png",
device = "png")
driver_results_df %>%
mutate(nationality = fct_lump(nationality, 9)) %>%
filter(nationality != "Other") %>%
add_count(year, wt = points, name = "total_year_points") %>%
group_by(year, nationality, total_year_points) %>%
summarize(year_points = sum(points)) %>%
ungroup() %>%
mutate(pct_points = year_points/total_year_points,
nationality = fct_reorder(nationality, -pct_points)) %>%
ggplot(aes(year, pct_points, color = nationality)) +
geom_line(show.legend = FALSE) +
scale_y_continuous(labels = percent_format()) +
facet_wrap(~nationality) +
labs(x = "",
y = "% of yearly points",
title = "Formula One Races",
subtitle = "Top 9 Nationalities by Percentage of Yearly Points",
caption = tt_caption)
# This will save your most recent plot
ggsave(
filename = "2021_09_07_tidy_tuesday.png",
device = "png")
driver_results_df %>%
add_count(driverId, wt = points, name = "driver_points")
driver_results_df %>%
count(driverId, wt = points, name = "driver_points", sort = TRUE)
driver_results_df %>%
count(driverId, forename, surname, wt = points, name = "driver_points", sort = TRUE)
driver_results_df %>%
count(driverId, wt = points, name = "driver_points", sort = TRUE)
driver_results_df %>%
count(driverId, wt = points, name = "driver_points", sort = TRUE) %>%
top_n(driverId, wt = points)
driver_results_df %>%
count(driverId, wt = points, name = "driver_points", sort = TRUE) %>%
top_n(9, wt = points)
driver_results_df %>%
count(driverId, wt = points, name = "driver_points", sort = TRUE) %>%
top_n(9, wt = driver_points)
driver_results_df %>%
count(driverId, wt = points, name = "driver_points", sort = TRUE) %>%
top_n(9, wt = driver_points) %>%
left_join(driver_results_df, by = "driverId") %>%
arrange(date) %>%
group_by(driverId) %>%
mutate(cumpoints = cumsum(points)) %>%
View()
driver_results_df %>%
count(driverId, wt = points, name = "driver_points", sort = TRUE) %>%
top_n(9, wt = driver_points) %>%
left_join(driver_results_df, by = "driverId") %>%
arrange(date) %>%
group_by(driverId) %>%
mutate(cumpoints = cumsum(points)) %>%
ungroup() %>%
mutate(driver_name = paste0(forename, " ", surname)) %>%
ggplot(aes(date, cumpoints, color = driver_name)) %>%
geom_step()
driver_results_df %>%
count(driverId, wt = points, name = "driver_points", sort = TRUE) %>%
top_n(9, wt = driver_points) %>%
left_join(driver_results_df, by = "driverId") %>%
arrange(date) %>%
group_by(driverId) %>%
mutate(cumpoints = cumsum(points)) %>%
ungroup() %>%
mutate(driver_name = paste0(forename, " ", surname)) %>%
ggplot(aes(date, cumpoints, color = driver_name)) +
geom_step()
driver_results_df %>%
count(driverId, wt = points, name = "driver_points", sort = TRUE) %>%
top_n(9, wt = driver_points) %>%
left_join(driver_results_df, by = "driverId") %>%
arrange(date) %>%
group_by(driverId) %>%
mutate(cumpoints = cumsum(points)) %>%
ungroup() %>%
mutate(driver_name = paste0(forename, " ", surname),
driver_name = fct_reorder(driver_name, driver_points)) %>%
ggplot(aes(date, cumpoints, color = driver_name)) +
geom_step()
driver_results_df %>%
count(driverId, wt = points, name = "driver_points", sort = TRUE) %>%
top_n(9, wt = driver_points) %>%
left_join(driver_results_df, by = "driverId") %>%
arrange(date) %>%
group_by(driverId) %>%
mutate(cumpoints = cumsum(points)) %>%
ungroup() %>%
mutate(driver_name = paste0(forename, " ", surname),
driver_name = fct_reorder(driver_name, -driver_points)) %>%
ggplot(aes(date, cumpoints, color = driver_name)) +
geom_step()
driver_results_df %>%
count(driverId, wt = points, name = "driver_points", sort = TRUE) %>%
top_n(9, wt = driver_points) %>%
left_join(driver_results_df, by = "driverId") %>%
arrange(date) %>%
group_by(driverId) %>%
mutate(cumpoints = cumsum(points)) %>%
ungroup() %>%
mutate(driver_name = paste0(forename, " ", surname),
driver_name = fct_reorder(driver_name, -driver_points)) %>%
ggplot(aes(date, cumpoints, color = driver_name)) +
geom_step() +
scale_y_continuous(labels = comma_format())
driver_results_df %>%
count(driverId, wt = points, name = "driver_points", sort = TRUE) %>%
top_n(10, wt = driver_points) %>%
left_join(driver_results_df, by = "driverId") %>%
arrange(date) %>%
group_by(driverId) %>%
mutate(cumpoints = cumsum(points)) %>%
ungroup() %>%
mutate(driver_name = paste0(forename, " ", surname),
driver_name = fct_reorder(driver_name, -driver_points)) %>%
ggplot(aes(date, cumpoints, color = driver_name)) +
geom_step() +
scale_y_continuous(labels = comma_format()) +
labs(x = "",
y = "# of points",
title = "Formula One Top Point Earners")
driver_results_df %>%
count(driverId, wt = points, name = "driver_points", sort = TRUE) %>%
top_n(10, wt = driver_points) %>%
left_join(driver_results_df, by = "driverId") %>%
arrange(date) %>%
group_by(driverId) %>%
mutate(cumpoints = cumsum(points)) %>%
ungroup() %>%
mutate(driver_name = paste0(forename, " ", surname),
driver_name = fct_reorder(driver_name, -driver_points)) %>%
ggplot(aes(date, cumpoints, color = driver_name)) +
geom_step() +
scale_y_continuous(labels = comma_format()) +
labs(x = "",
y = "# of points",
title = "Formula One Top 10 Point Earners",
subtitle = "",
caption = tt_caption)
driver_results_df %>%
count(driverId, wt = points, name = "driver_points", sort = TRUE) %>%
top_n(10, wt = driver_points) %>%
left_join(driver_results_df, by = "driverId") %>%
arrange(date) %>%
group_by(driverId) %>%
mutate(cumpoints = cumsum(points)) %>%
ungroup() %>%
mutate(driver_name = paste0(forename, " ", surname),
driver_name = fct_reorder(driver_name, -driver_points)) %>%
ggplot(aes(date, cumpoints, color = driver_name)) +
geom_step() +
scale_y_continuous(labels = comma_format()) +
labs(x = "",
y = "# of points",
color = "",
title = "Formula One Top 10 Point Earners",
subtitle = "",
caption = tt_caption)
driver_results_df %>%
count(driverId, wt = points, name = "driver_points", sort = TRUE) %>%
top_n(5, wt = driver_points) %>%
left_join(driver_results_df, by = "driverId") %>%
arrange(date) %>%
group_by(driverId) %>%
mutate(cumpoints = cumsum(points)) %>%
ungroup() %>%
mutate(driver_name = paste0(forename, " ", surname),
driver_name = fct_reorder(driver_name, -driver_points)) %>%
ggplot(aes(date, cumpoints, color = driver_name)) +
geom_step() +
scale_y_continuous(labels = comma_format()) +
labs(x = "",
y = "# of points",
color = "",
title = "Formula One Top 10 Point Earners",
subtitle = "",
caption = tt_caption)
driver_results_df %>%
count(driverId, wt = points, name = "driver_points", sort = TRUE) %>%
top_n(10, wt = driver_points) %>%
left_join(driver_results_df, by = "driverId") %>%
arrange(date) %>%
group_by(driverId) %>%
mutate(cumpoints = cumsum(points)) %>%
ungroup() %>%
mutate(driver_name = paste0(forename, " ", surname),
driver_name = fct_reorder(driver_name, -driver_points)) %>%
ggplot(aes(date, cumpoints, color = driver_name)) +
geom_step() +
scale_y_continuous(labels = comma_format()) +
labs(x = "",
y = "# of points",
color = "",
title = "Formula One Top 10 Point Earners",
subtitle = "",
caption = tt_caption)
driver_results_df %>%
count(driverId, wt = points, name = "driver_points", sort = TRUE) %>%
top_n(10, wt = driver_points) %>%
left_join(driver_results_df, by = "driverId") %>%
arrange(date) %>%
group_by(driverId) %>%
mutate(cumpoints = cumsum(points)) %>%
ungroup() %>%
mutate(driver_name = paste0(forename, " ", surname),
driver_name = fct_reorder(driver_name, -driver_points)) %>%
ggplot(aes(date, cumpoints, color = driver_name)) +
geom_step() +
scale_y_continuous(labels = comma_format()) +
labs(x = "",
y = "# of points",
color = "",
title = "Formula One Top 10 Point Earners",
subtitle = "All but Schumacher started racing after 2000",
caption = tt_caption)
