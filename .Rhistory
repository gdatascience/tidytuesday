group_by(state) %>%
summarize(avg_avlblty = mean(county_bb_avlblty, na.rm = TRUE)) %>%
ungroup() %>%
mutate(state = fct_reorder(state, avg_avlblty)) %>%
ggplot(aes(avg_avlblty, state, fill = state)) +
geom_col(show.legend = FALSE) +
scale_x_continuous(labels = percent) +
labs(x = "% of people with access to broadband",
y = "",
title = "US States: 2017 Access to Broadband",
subtitle = "Fixed terrestrial broadband at speeds of 25 Mbps/3 Mbps",
caption = tt_caption)
library(zipcodeR)
ca_zips <- search_state('CA') %>%
mutate(zipcode = parse_number(zipcode))
ca_zip_df <- ca_zips %>%
left_join(broadband, by = c("zipcode" = "postal_code"))
ca_zip_df %>%
#mutate(usage_per_dollar = broadband_usage / median_household_income) %>%
ggplot(aes(lng, lat, color = broadband_usage)) +
geom_point(alpha = 0.5) +
coord_map()
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(tidytuesdayR)
library(scales)
library(lubridate)
theme_set(theme_light())
tt_caption <- "Source: Ask A Manager  |  Analysis: Tony Galvan (@GDataScience1)"
tt <- tt_load("2021-05-18")
tt
survey <- tt$survey %>%
mutate(timestamp = mdy_hms(timestamp),
gender = recode(gender,
"Prefer not to answer" = "Other/No Answer",
"Other or prefer not to answer" = "Other/No Answer"),
country = recode(country,
"USA" = "United States",
"US" = "United States",
"Us" = "United States",
"U.S." = "United States",
"Usa" = "United States",
"usa" = "United States",
"United states" = "United States",
"united states" = "United States",
"United States of America" = "United States",
"England" = "United Kingdom",
"UK" = "United Kingdom",
"Uk" = "United Kingdom"))
View(survey)
survey %>%
count(how_old_are_you) %>%
mutate(how_old_are_you = fct_relevel(how_old_are_you, "under 18"),
how_old_are_you = fct_rev(how_old_are_you)) %>%
ggplot(aes(n, how_old_are_you, fill = how_old_are_you)) +
geom_col(show.legend = FALSE) +
labs(x = "# of respondents",
y = "",
title = "Salary Survey",
subtitle = "How old were the respondents?",
caption = tt_caption)
survey %>%
count(how_old_are_you) %>%
mutate(how_old_are_you = fct_relevel(how_old_are_you, "under 18"),
how_old_are_you = fct_rev(how_old_are_you)) %>%
ggplot(aes(n, how_old_are_you, fill = how_old_are_you)) +
geom_col(show.legend = FALSE) +
labs(x = "# of respondents",
y = "",
title = "Salary Survey",
subtitle = "How old were the respondents?",
caption = tt_caption)
survey %>%
ggplot(aes(timestamp)) +
geom_histogram()
survey %>%
count(how_old_are_you) %>%
mutate(how_old_are_you = fct_relevel(how_old_are_you, "under 18"),
how_old_are_you = fct_rev(how_old_are_you)) %>%
ggplot(aes(n, how_old_are_you, fill = how_old_are_you)) +
geom_col(show.legend = FALSE) +
labs(x = "# of respondents",
y = "",
title = "Salary Survey",
subtitle = "How old were the respondents?",
caption = tt_caption)
survey %>%
mutate(industry = fct_lump(industry, 10)) %>%
filter(!is.na(industry),
industry != "Other") %>%
count(industry) %>%
mutate(industry = fct_reorder(industry, n)) %>%
ggplot(aes(n, industry, fill = industry)) +
geom_col(show.legend = FALSE) +
labs(x = "# of respondents",
y = "",
title = "Salary Survey",
subtitle = "What were the top 10 industries for the respondents?",
caption = tt_caption)
survey %>%
mutate(job_title = fct_lump(job_title, 10)) %>%
filter(!is.na(job_title),
job_title != "Other") %>%
count(job_title) %>%
mutate(job_title = fct_reorder(job_title, n)) %>%
ggplot(aes(n, job_title, fill = job_title)) +
geom_col(show.legend = FALSE) +
labs(x = "# of respondents",
y = "",
title = "Salary Survey",
subtitle = "What were the top 10 job titles for the respondents?",
caption = tt_caption)
survey %>%
mutate(country = fct_lump(country, 10)) %>%
filter(!is.na(country),
country != "Other") %>%
count(country) %>%
mutate(country = fct_reorder(country, n)) %>%
ggplot(aes(n, country, fill = country)) +
geom_col(show.legend = FALSE) +
scale_x_log10() +
labs(x = "# of respondents",
y = "",
title = "Salary Survey",
subtitle = "What were the top 10 countries for the respondents?",
caption = tt_caption)
survey %>%
mutate(gender = ifelse(is.na(gender), "Other/No Answer", gender)) %>%
count(gender) %>%
mutate(gender = fct_reorder(gender, n)) %>%
ggplot(aes(n, gender, fill = gender)) +
geom_col(show.legend = FALSE) +
labs(x = "# of respondents",
y = "",
title = "Salary Survey",
subtitle = "What gender were the respondents?",
caption = tt_caption)
survey %>%
mutate(race = ifelse(race == "Another option not listed here or prefer not to answer", "Other", race),
race = fct_lump(race, 5)) %>%
filter(!is.na(race)) %>%
count(race) %>%
mutate(race = fct_reorder(race, n)) %>%
ggplot(aes(n, race, fill = race)) +
geom_col(show.legend = FALSE) +
labs(x = "# of respondents",
y = "",
title = "Salary Survey",
subtitle = "What race were the respondents?",
caption = tt_caption)
survey %>%
mutate(gender = ifelse(is.na(gender), "Other/No Answer", gender)) %>%
group_by(gender) %>%
summarize(avg_salary = mean(annual_salary, na.rm = TRUE))
survey %>%
mutate(gender = ifelse(is.na(gender), "Other/No Answer", gender)) %>%
gglot(aes(annual_salary, gender)) +
geom_boxplot()
survey %>%
mutate(gender = ifelse(is.na(gender), "Other/No Answer", gender)) %>%
ggplot(aes(annual_salary, gender)) +
geom_boxplot()
survey %>%
mutate(gender = ifelse(is.na(gender), "Other/No Answer", gender)) %>%
ggplot(aes(annual_salary, gender)) +
geom_boxplot() +
scale_x_log10()
survey %>%
mutate(gender = ifelse(is.na(gender), "Other/No Answer", gender)) %>%
ggplot(aes(annual_salary, gender)) +
geom_boxplot() +
scale_x_log10(labels = dollar)
survey %>%
filter(currency == "USD") %>%
mutate(gender = ifelse(is.na(gender), "Other/No Answer", gender)) %>%
ggplot(aes(annual_salary, gender)) +
geom_boxplot() +
scale_x_log10(labels = dollar)
survey %>%
filter(currency == "USD") %>%
mutate(gender = ifelse(is.na(gender), "Other/No Answer", gender)) %>%
ggplot(aes(annual_salary, gender)) +
geom_violin() +
scale_x_log10(labels = dollar)
survey %>%
filter(currency == "USD",
annual_salary <= 10000000) %>%
mutate(gender = ifelse(is.na(gender), "Other/No Answer", gender)) %>%
ggplot(aes(annual_salary, gender)) +
geom_violin() +
scale_x_log10(labels = dollar)
survey %>%
filter(currency == "USD",
annual_salary <= 10000000) %>%
mutate(gender = ifelse(is.na(gender), "Other/No Answer", gender)) %>%
ggplot(aes(annual_salary, gender)) +
geom_violin() +
scale_x_continuous(labels = dollar)
survey %>%
filter(currency == "USD",
annual_salary <= 10000000) %>%
mutate(gender = ifelse(is.na(gender), "Other/No Answer", gender)) %>%
ggplot(aes(annual_salary, gender, fill = gender)) +
geom_violin(show.legend = FALSE) +
scale_x_continuous(labels = dollar)
survey %>%
filter(currency == "USD",
annual_salary <= 10000000) %>%
mutate(gender = ifelse(is.na(gender), "Other/No Answer", gender)) %>%
ggplot(aes(annual_salary, gender, fill = gender)) +
geom_violin(show.legend = FALSE) +
scale_x_LOG10(labels = dollar)
survey %>%
filter(currency == "USD",
annual_salary <= 10000000) %>%
mutate(gender = ifelse(is.na(gender), "Other/No Answer", gender)) %>%
ggplot(aes(annual_salary, gender, fill = gender)) +
geom_violin(show.legend = FALSE) +
scale_x_log10(labels = dollar)
gender = fct_reorder(gender, annual_salary)) %>%
survey %>%
filter(currency == "USD",
annual_salary <= 10000000) %>%
mutate(gender = ifelse(is.na(gender), "Other/No Answer", gender),
gender = fct_reorder(gender, annual_salary)) %>%
ggplot(aes(annual_salary, gender, fill = gender)) +
geom_violin(show.legend = FALSE) +
scale_x_log10(labels = dollar)
survey %>%
filter(currency == "USD",
annual_salary <= 10000000) %>%
mutate(race = ifelse(is.na(race), "Other/No Answer", race),
race = fct_reorder(race, annual_salary)) %>%
ggplot(aes(annual_salary, race, fill = race)) +
geom_violin(show.legend = FALSE) +
scale_x_log10(labels = dollar)
survey %>%
filter(currency == "USD",
annual_salary <= 10000000) %>%
mutate(race = ifelse(race == "Another option not listed here or prefer not to answer", "Other", race),
race = fct_lump(race, 5),
race = fct_reorder(race, annual_salary)) %>%
ggplot(aes(annual_salary, race, fill = race)) +
geom_violin(show.legend = FALSE) +
scale_x_log10(labels = dollar)
survey %>%
filter(currency == "USD",
annual_salary <= 10000000) %>%
mutate(race = ifelse(race == "Another option not listed here or prefer not to answer", "Other", race),
race = fct_lump(race, 5),
race = fct_reorder(race, annual_salary)) %>%
ggplot(aes(annual_salary, race, fill = race)) +
geom_violin(show.legend = FALSE) +
scale_x_log10(labels = dollar) +
facet_wrap(~gender)
survey %>%
filter(currency == "USD",
annual_salary <= 10000000) %>%
mutate(gender = ifelse(is.na(gender), "Other/No Answer", gender),
race = ifelse(race == "Another option not listed here or prefer not to answer", "Other", race),
race = fct_lump(race, 5),
race = fct_reorder(race, annual_salary)) %>%
ggplot(aes(annual_salary, race, fill = race)) +
geom_violin(show.legend = FALSE) +
scale_x_log10(labels = dollar) +
facet_wrap(~gender)
library(tidytext)
survey %>%
filter(currency == "USD",
annual_salary <= 10000000) %>%
mutate(gender = ifelse(is.na(gender), "Other/No Answer", gender),
race = ifelse(race == "Another option not listed here or prefer not to answer", "Other", race),
race = fct_lump(race, 5),
race = reorder_within(race, annual_salary)) %>%
ggplot(aes(annual_salary, race, fill = race)) +
geom_violin(show.legend = FALSE) +
scale_x_log10(labels = dollar) +
scale_y_reordered() +
facet_wrap(~gender)
survey %>%
filter(currency == "USD",
annual_salary <= 10000000) %>%
mutate(gender = ifelse(is.na(gender), "Other/No Answer", gender),
race = ifelse(race == "Another option not listed here or prefer not to answer", "Other", race),
race = fct_lump(race, 5),
race = reorder_within(race, annual_salary, gender)) %>%
ggplot(aes(annual_salary, race, fill = race)) +
geom_violin(show.legend = FALSE) +
scale_x_log10(labels = dollar) +
scale_y_reordered() +
facet_wrap(~gender)
survey %>%
filter(currency == "USD",
annual_salary <= 10000000) %>%
mutate(gender = ifelse(is.na(gender), "Other/No Answer", gender),
race = ifelse(race == "Another option not listed here or prefer not to answer", "Other", race),
race = fct_lump(race, 5),
race = reorder_within(race, annual_salary, gender)) %>%
ggplot(aes(annual_salary, race, fill = race)) +
geom_violin(show.legend = FALSE) +
scale_x_log10(labels = dollar) +
scale_y_reordered() +
facet_wrap(~gender, scales = "free_y")
survey %>%
filter(currency == "USD",
annual_salary <= 10000000) %>%
mutate(gender = ifelse(is.na(gender), "Other/No Answer", gender),
gender = fct_reorder(gender, annual_salary)) %>%
ggplot(aes(annual_salary, gender, fill = gender)) +
geom_violin(show.legend = FALSE) +
scale_x_log10(labels = dollar)
survey %>%
filter(currency == "USD",
annual_salary <= 10000000) %>%
mutate(gender = ifelse(is.na(gender), "Other/No Answer", gender),
race = ifelse(race == "Another option not listed here or prefer not to answer", "Other", race),
race = fct_lump(race, 5),
race = reorder_within(race, annual_salary, gender)) %>%
ggplot(aes(annual_salary, race, fill = race)) +
geom_violin(show.legend = FALSE) +
scale_x_log10(labels = dollar) +
scale_y_reordered() +
facet_wrap(~gender, scales = "free_y") +
labs(x = "Annual salary in USD",
y = "",
title = "Salary Survey",
subtitle = "Annual salaries reported by race and gender",
caption = tt_caption)
survey %>%
filter(currency == "USD",
annual_salary <= 10000000) %>%
mutate(gender = ifelse(is.na(gender), "Other/No Answer", gender),
gender = fct_reorder(gender, annual_salary),
race = ifelse(race == "Another option not listed here or prefer not to answer", "Other", race),
race = fct_lump(race, 5),
race = reorder_within(race, annual_salary, gender)) %>%
ggplot(aes(annual_salary, race, fill = race)) +
geom_violin(show.legend = FALSE) +
scale_x_log10(labels = dollar) +
scale_y_reordered() +
facet_wrap(~gender, scales = "free_y") +
labs(x = "Annual salary in USD",
y = "",
title = "Salary Survey",
subtitle = "Annual salaries reported by race and gender",
caption = tt_caption)
survey %>%
filter(currency == "USD",
annual_salary <= 10000000) %>%
mutate(gender = ifelse(is.na(gender), "Other/No Answer", gender),
gender = fct_reorder(gender, -annual_salary),
race = ifelse(race == "Another option not listed here or prefer not to answer", "Other", race),
race = fct_lump(race, 5),
race = reorder_within(race, annual_salary, gender)) %>%
ggplot(aes(annual_salary, race, fill = race)) +
geom_violin(show.legend = FALSE) +
scale_x_log10(labels = dollar) +
scale_y_reordered() +
facet_wrap(~gender, scales = "free_y") +
labs(x = "Annual salary in USD",
y = "",
title = "Salary Survey",
subtitle = "Annual salaries reported by race and gender",
caption = tt_caption)
# This will save your most recent plot
ggsave(
filename = "2021_05_18_tidy_tuesday.png",
device = "png")
survey %>%
filter(currency == "USD",
annual_salary <= 10000000) %>%
mutate(gender = ifelse(is.na(gender), "Other/No Answer", gender),
gender = fct_reorder(gender, -annual_salary),
race = ifelse(race == "Another option not listed here or prefer not to answer", "Other", race),
race = fct_lump(race, 5),
race = reorder_within(race, annual_salary, gender)) %>%
ggplot(aes(annual_salary, race, fill = race)) +
geom_violin(show.legend = FALSE) +
scale_x_log10(labels = dollar) +
scale_y_reordered() +
facet_wrap(~gender, scales = "free_y", ncol = 1) +
labs(x = "Annual salary in USD",
y = "",
title = "Salary Survey",
subtitle = "Annual salaries reported by race and gender",
caption = tt_caption)
# This will save your most recent plot
ggsave(
filename = "2021_05_18_tidy_tuesday.png",
device = "png")
survey %>%
filter(currency == "USD",
annual_salary >= 1000,
annual_salary <= 10000000) %>%
mutate(gender = ifelse(is.na(gender), "Other/No Answer", gender),
gender = fct_reorder(gender, -annual_salary),
race = ifelse(race == "Another option not listed here or prefer not to answer", "Other", race),
race = fct_lump(race, 5),
race = reorder_within(race, annual_salary, gender)) %>%
ggplot(aes(annual_salary, race, fill = race)) +
geom_violin(show.legend = FALSE) +
scale_x_log10(labels = dollar) +
scale_y_reordered() +
facet_wrap(~gender, scales = "free_y", ncol = 1) +
labs(x = "Annual salary in USD",
y = "",
title = "Salary Survey",
subtitle = "Annual salaries reported by race and gender",
caption = tt_caption)
survey %>%
filter(currency == "USD",
annual_salary >= 1000,
annual_salary <= 10000000) %>%
mutate(gender = ifelse(is.na(gender), "Other/No Answer", gender),
gender = fct_reorder(gender, -annual_salary),
race = ifelse(race == "Another option not listed here or prefer not to answer", "Other", race),
race = fct_lump(race, 5),
race = reorder_within(race, annual_salary, gender)) %>%
ggplot(aes(annual_salary, race, fill = gender)) +
geom_violin(show.legend = FALSE) +
scale_x_log10(labels = dollar) +
scale_y_reordered() +
facet_wrap(~gender, scales = "free_y", ncol = 1) +
labs(x = "Annual salary in USD",
y = "",
title = "Salary Survey",
subtitle = "Annual salaries reported by race and gender",
caption = tt_caption)
# This will save your most recent plot
ggsave(
filename = "2021_05_18_tidy_tuesday.png",
device = "png")
survey %>%
filter(currency == "USD",
annual_salary >= 1000,
annual_salary <= 10000000) %>%
mutate(gender = ifelse(is.na(gender), "Other/No Answer", gender),
gender = fct_reorder(gender, -annual_salary),
race = ifelse(race == "Another option not listed here or prefer not to answer", "Other", race),
race = fct_lump(race, 5),
race = reorder_within(race, annual_salary, gender)) %>%
ggplot(aes(annual_salary, race, fill = gender)) +
geom_violin(show.legend = FALSE) +
scale_x_continuous(labels = dollar) +
scale_y_reordered() +
facet_wrap(~gender, scales = "free_y", ncol = 1) +
labs(x = "Annual salary in USD",
y = "",
title = "Salary Survey",
subtitle = "Annual salaries reported by race and gender",
caption = tt_caption)
survey %>%
filter(currency == "USD",
annual_salary >= 1000,
annual_salary <= 1000000) %>%
mutate(gender = ifelse(is.na(gender), "Other/No Answer", gender),
gender = fct_reorder(gender, -annual_salary),
race = ifelse(race == "Another option not listed here or prefer not to answer", "Other", race),
race = fct_lump(race, 5),
race = reorder_within(race, annual_salary, gender)) %>%
ggplot(aes(annual_salary, race, fill = gender)) +
geom_violin(show.legend = FALSE) +
scale_x_continuous(labels = dollar) +
scale_y_reordered() +
facet_wrap(~gender, scales = "free_y", ncol = 1) +
labs(x = "Annual salary in USD",
y = "",
title = "Salary Survey",
subtitle = "Annual salaries reported by race and gender",
caption = tt_caption)
survey %>%
filter(currency == "USD",
annual_salary >= 1000,
annual_salary <= 10000000) %>%
mutate(gender = ifelse(is.na(gender), "Other/No Answer", gender),
gender = fct_reorder(gender, -annual_salary),
race = ifelse(race == "Another option not listed here or prefer not to answer", "Other", race),
race = fct_lump(race, 5),
race = reorder_within(race, annual_salary, gender)) %>%
ggplot(aes(annual_salary, race, fill = gender)) +
geom_violin(show.legend = FALSE) +
scale_x_continuous(labels = dollar) +
scale_y_reordered() +
facet_wrap(~gender, scales = "free_y", ncol = 1) +
labs(x = "Annual salary in USD",
y = "",
title = "Salary Survey",
subtitle = "Annual salaries reported by race and gender",
caption = tt_caption)
survey %>%
filter(currency == "USD",
annual_salary >= 1000,
annual_salary <= 10000000) %>%
mutate(gender = ifelse(is.na(gender), "Other/No Answer", gender),
gender = fct_reorder(gender, -annual_salary),
race = ifelse(race == "Another option not listed here or prefer not to answer", "Other", race),
race = fct_lump(race, 5),
race = reorder_within(race, annual_salary, gender)) %>%
ggplot(aes(annual_salary, race, fill = gender)) +
geom_violin(show.legend = FALSE) +
scale_x_log10(labels = dollar) +
scale_y_reordered() +
facet_wrap(~gender, scales = "free_y", ncol = 1) +
labs(x = "Annual salary in USD",
y = "",
title = "Salary Survey",
subtitle = "Annual salaries reported by race and gender",
caption = tt_caption)
# This will save your most recent plot
ggsave(
filename = "2021_05_18_tidy_tuesday.png",
device = "png")
