knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(tidytuesdayR)
library(scales)
theme_set(theme_light())
tt_caption <- "Source: Bureau of Economic Analysis  |  Analysis: Tony Galvan (@GDataScience1)"
tt <- tt_load("2021-08-10")
tt
tt %>%
map(glimpse)
investment <- tt$investment
glimpse(investment)
summary(investment$year)
investment %>%
count(meta_cat, sort = TRUE)
investment %>%
filter(!str_detect(meta_cat, "Total")) %>%
group_by(meta_cat, year) %>%
summarize(total_inv = sum(gross_inv))
investment %>%
filter(!str_detect(meta_cat, "Total")) %>%
group_by(meta_cat, year) %>%
summarize(total_inv = sum(gross_inv)) %>%
ggplot(aes(year, total_inv)) +
geom_line() +
scale_y_continuous(labels = dollar_format()) +
facet_wrap(~meta_cat, scales = "free_y")
investment %>%
filter(!str_detect(meta_cat, "Total")) %>%
group_by(meta_cat, year) %>%
summarize(total_inv = sum(gross_inv)) %>%
ggplot(aes(year, total_inv)) +
geom_line() +
#scale_y_continuous(labels = dollar_format()) +
facet_wrap(~meta_cat, scales = "free_y")
investment %>%
filter(!str_detect(meta_cat, "Total")) %>%
group_by(meta_cat, year) %>%
summarize(total_inv = sum(gross_inv)) %>%
ggplot(aes(year, total_inv)) +
geom_line() +
scale_y_continuous(labels = dollar_format()) +
facet_wrap(~meta_cat, scales = "free_y")
investment %>%
filter(group_num == 1) %>%
add_count(year, wt = gross_inv, name = "total_inv")
investment %>%
filter(group_num == 1) %>%
add_count(year, wt = gross_inv, name = "total_inv") %>%
mutate(pct_inv = gross_inv / total_inv,
category = case_when(
str_detect(category, "digital") ~ "Digital",
str_detect(category, "social") ~ "Social",
TRUE ~ "Basic"
),
category = fct_reorder(category, pct_inv))
investment %>%
filter(group_num == 1) %>%
add_count(year, wt = gross_inv, name = "total_inv") %>%
mutate(pct_inv = gross_inv / total_inv,
category = case_when(
str_detect(category, "digital") ~ "Digital",
str_detect(category, "social") ~ "Social",
TRUE ~ "Basic"
),
category = fct_reorder(category, pct_inv)) %>%
ggplot(aes(year, pct_inv, fill = category)) +
geom_area() +
scale_y_continuous(labels = percent_format()) +
labs(x = "",
y = "% of total investment",
title = "BEA Infrastructure Investment",
subtitle = "Percentage of total investment in digital and social infrastructure has been increasing",
caption = tt_caption)
investment %>%
filter(group_num == 1) %>%
add_count(year, wt = gross_inv, name = "total_inv") %>%
mutate(pct_inv = gross_inv / total_inv,
category = case_when(
str_detect(category, "digital") ~ "Digital",
str_detect(category, "social") ~ "Social",
TRUE ~ "Basic"
),
category = fct_reorder(category, pct_inv)) %>%
ggplot(aes(year, pct_inv, fill = category)) +
geom_area() +
scale_y_continuous(labels = percent_format())
investment %>%
filter(group_num == 1) %>%
add_count(year, wt = gross_inv, name = "total_inv") %>%
mutate(pct_inv = gross_inv / total_inv,
category = case_when(
str_detect(category, "digital") ~ "Digital",
str_detect(category, "social") ~ "Social",
TRUE ~ "Basic"
),
category = fct_reorder(category, pct_inv)) %>%
ggplot(aes(year, pct_inv, fill = category)) +
geom_area() +
scale_y_continuous(labels = percent_format()) +
labs(x = "",
y = "% of total investment",
title = "BEA Infrastructure Investment",
subtitle = "Percentage of total investment in digital and social infrastructure has been increasing",
caption = tt_caption)
investment %>%
filter(group_num == 1) %>%
add_count(year, wt = gross_inv, name = "total_inv") %>%
mutate(pct_inv = gross_inv / total_inv,
category = case_when(
str_detect(category, "digital") ~ "Digital",
str_detect(category, "social") ~ "Social",
TRUE ~ "Basic"
),
category = fct_reorder(category, pct_inv)) %>%
ggplot(aes(year, pct_inv, fill = category)) +
geom_area() +
scale_y_continuous(labels = percent_format()) +
labs(x = "",
y = "% of total investment",
fill = "Investment Category",
title = "BEA Infrastructure Investment",
subtitle = "Percentage of total investment in digital and social infrastructure has been increasing",
caption = tt_caption)
tidytuesdayR::use_tidytemplate()
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(tidytuesdayR)
tt <- tt_load("2021-08-17")
tt
tt %>%
map(glimpse)
tt$computer %>%
count(type, sort = TRUE)
tt$computer %>%
count(domain, sort = TRUE)
tt$computer %>%
count(sub_domain, sort = TRUE)
computer <- tt$computer
computer %>%
count(type, sort = TRUE)
computer %>%
count(domain, sort = TRUE)
computer %>%
count(sub_domain, sort = TRUE)
computer %>%
count(type, sort = TRUE) %>%
ggplot(aes(n, type, fill = type)) +
geom_col(show.legend = FALSE)
computer %>%
count(type, sort = TRUE) %>%
mutate(type = fct_reorder(type, n)) %>%
ggplot(aes(n, type, fill = type)) +
geom_col(show.legend = FALSE)
computer <- tt$computer %>%
mutate(type = str_to_title(type))
computer %>%
count(type, sort = TRUE) %>%
mutate(type = fct_reorder(type, n)) %>%
ggplot(aes(n, type, fill = type)) +
geom_col(show.legend = FALSE)
theme_set(theme_light())
computer %>%
count(type, sort = TRUE) %>%
mutate(type = fct_reorder(type, n)) %>%
ggplot(aes(n, type, fill = type)) +
geom_col(show.legend = FALSE)
# This will save your most recent plot
ggsave(
filename = "2021_08_17_tidy_tuesday.png",
device = "png")
