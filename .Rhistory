facet_wrap(~team)
View(olympics)
olympics %>%
filter(!is.na(medal)) %>%
count(team) %>%
top_n(9, n) %>%
inner_join(olympics%>%
filter(!is.na(medal)),
by = "team") %>%
mutate(team = fct_reorder(team, -n),
medal = fct_rev(fct_relevel(medal, "Gold", "Silver"))) %>%
count(year, team, medal, sort = TRUE) %>%
ggplot(aes(year, n, color = medal)) +
geom_step() +
facet_wrap(~team)
olympics %>%
filter(!is.na(medal)) %>%
count(team) %>%
top_n(9, n) %>%
inner_join(olympics%>%
filter(!is.na(medal)),
by = "team") %>%
mutate(team = fct_reorder(team, -n),
medal = fct_rev(fct_relevel(medal, "Gold", "Silver"))) %>%
count(year, team, medal, sort = TRUE) %>%
mutate(counter = cumsum(n))
olympics %>%
filter(!is.na(medal)) %>%
count(team) %>%
top_n(9, n) %>%
inner_join(olympics%>%
filter(!is.na(medal)),
by = "team") %>%
mutate(team = fct_reorder(team, -n),
medal = fct_rev(fct_relevel(medal, "Gold", "Silver"))) %>%
group_by(year, team, medal) %>%
mutate(counter = cumsum(n))
olympics %>%
filter(!is.na(medal)) %>%
count(team) %>%
top_n(9, n) %>%
inner_join(olympics%>%
filter(!is.na(medal)),
by = "team") %>%
mutate(team = fct_reorder(team, -n),
medal = fct_rev(fct_relevel(medal, "Gold", "Silver"))) %>%
count(year, team, medal) %>%
ggplot(aes(year, n, color = medal)) +
geom_step() +
facet_wrap(~team)
olympics %>%
filter(!is.na(medal)) %>%
count(team) %>%
top_n(9, n) %>%
inner_join(olympics%>%
filter(!is.na(medal)),
by = "team") %>%
mutate(team = fct_reorder(team, -n),
medal = fct_relevel(medal, "Gold", "Silver")) %>%
count(year, team, medal) %>%
ggplot(aes(year, n, color = medal)) +
geom_step() +
facet_wrap(~team)
olympics %>%
filter(!is.na(medal)) %>%
count(team) %>%
top_n(9, n) %>%
inner_join(olympics%>%
filter(!is.na(medal)),
by = "team") %>%
mutate(team = fct_reorder(team, -n),
medal = fct_relevel(medal, "Gold", "Silver")) %>%
count(year, team, medal) %>%
mutate(counter = cumsum(n))
olympics %>%
filter(!is.na(medal)) %>%
count(team) %>%
top_n(9, n) %>%
inner_join(olympics%>%
filter(!is.na(medal)),
by = "team") %>%
mutate(team = fct_reorder(team, -n),
medal = fct_relevel(medal, "Gold", "Silver")) %>%
count(year, team, medal) %>%
group_by(team, medal) %>%
mutate(counter = cumsum(n))
ggplot(aes(year, counter, color = medal)) +
geom_step() +
facet_wrap(~team)
olympics %>%
filter(!is.na(medal)) %>%
count(team) %>%
top_n(9, n) %>%
inner_join(olympics%>%
filter(!is.na(medal)),
by = "team") %>%
mutate(team = fct_reorder(team, -n),
medal = fct_relevel(medal, "Gold", "Silver")) %>%
count(year, team, medal) %>%
group_by(team, medal) %>%
mutate(counter = cumsum(n)) %>%
ungroup() %>%
ggplot(aes(year, counter, color = medal)) +
geom_step() +
facet_wrap(~team)
olympics %>%
filter(!is.na(medal)) %>%
count(team) %>%
top_n(9, n) %>%
inner_join(olympics%>%
filter(!is.na(medal)),
by = "team") %>%
mutate(team = fct_reorder(team, -n),
medal = fct_relevel(medal, "Gold", "Silver")) %>%
count(year, team, medal) %>%
group_by(team, medal) %>%
mutate(counter = cumsum(n)) %>%
ungroup() %>%
ggplot(aes(year, counter, color = medal)) +
geom_step() +
facet_wrap(~team, scales = "free_y")
olympics %>%
filter(!is.na(medal)) %>%
count(team) %>%
top_n(9, n) %>%
inner_join(olympics%>%
filter(!is.na(medal)),
by = "team") %>%
mutate(team = fct_reorder(team, -n),
medal = fct_relevel(medal, "Gold", "Silver")) %>%
count(year, team, medal) %>%
group_by(team, medal) %>%
mutate(counter = cumsum(n)) %>%
ungroup() %>%
ggplot(aes(year, counter, color = medal)) +
geom_step() +
facet_wrap(~team) #, scales = "free_y")
olympics %>%
filter(!is.na(medal)) %>%
count(team) %>%
top_n(9, n) %>%
inner_join(olympics%>%
filter(!is.na(medal)),
by = "team") %>%
mutate(team = fct_reorder(team, -n),
medal = fct_relevel(medal, "Gold", "Silver")) %>%
count(year, team, medal) %>%
group_by(team, medal) %>%
mutate(counter = cumsum(n)) %>%
ungroup() %>%
ggplot(aes(year, counter, color = medal)) +
geom_step() +
facet_wrap(~team, scales = "free_y")
olympics %>%
filter(!is.na(medal)) %>%
count(team) %>%
top_n(9, n) %>%
inner_join(olympics%>%
filter(!is.na(medal)),
by = "team") %>%
mutate(team = fct_reorder(team, -n),
medal = fct_relevel(medal, "Gold", "Silver")) %>%
count(year, team, medal) %>%
group_by(team, medal) %>%
mutate(counter = cumsum(n)) %>%
ungroup() %>%
ggplot(aes(year, counter, color = medal)) +
geom_step() +
facet_wrap(~team, scales = "free_y") +
scale_color_manual(values = c("#FCA311", "#D8DDDE", "#B0413E"))
olympics %>%
filter(!is.na(medal)) %>%
count(team) %>%
top_n(9, n) %>%
inner_join(olympics%>%
filter(!is.na(medal)),
by = "team") %>%
mutate(team = fct_reorder(team, -n),
medal = fct_relevel(medal, "Gold", "Silver")) %>%
count(year, team, medal) %>%
group_by(team, medal) %>%
mutate(counter = cumsum(n)) %>%
ungroup() %>%
ggplot(aes(year, counter, color = medal)) +
geom_step() +
facet_wrap(~team, scales = "free_y") +
scale_color_manual(values = c("#FCA311", "#D8DDDE", "#88A096"))
olympics %>%
filter(!is.na(medal)) %>%
count(team) %>%
top_n(9, n) %>%
inner_join(olympics%>%
filter(!is.na(medal)),
by = "team") %>%
mutate(team = fct_reorder(team, -n),
medal = fct_relevel(medal, "Gold", "Silver")) %>%
count(year, team, medal) %>%
group_by(team, medal) %>%
mutate(counter = cumsum(n)) %>%
ungroup() %>%
ggplot(aes(year, counter, color = medal)) +
geom_step() +
facet_wrap(~team, scales = "free_y") +
scale_color_manual(values = c("#FCA311", "#D8DDDE", "#88A096"))
olympics %>%
filter(!is.na(medal)) %>%
count(team) %>%
top_n(9, n) %>%
inner_join(olympics%>%
filter(!is.na(medal)),
by = "team") %>%
mutate(team = fct_reorder(team, -n),
medal = fct_relevel(medal, "Gold", "Silver")) %>%
count(year, team, medal) %>%
group_by(team, medal) %>%
mutate(counter = cumsum(n)) %>%
ungroup() %>%
ggplot(aes(year, counter, color = medal)) +
geom_step() +
facet_wrap(~team, scales = "free_y") +
scale_color_manual(values = c("#FCA311", "#88A096", "#B0413E"))
olympics %>%
filter(!is.na(medal)) %>%
count(team) %>%
top_n(9, n) %>%
inner_join(olympics%>%
filter(!is.na(medal)),
by = "team") %>%
mutate(team = fct_reorder(team, -n),
medal = fct_rev(fct_relevel(medal, "Gold", "Silver"))) %>%
count(team, medal, sort = TRUE) %>%
ggplot(aes(n, medal, fill = medal)) +
geom_col(show.legend = FALSE) +
facet_wrap(~team) +
scale_fill_manual(values = c("#FCA311", "#88A096", "#B0413E"))
olympics %>%
filter(!is.na(medal)) %>%
count(team) %>%
top_n(9, n) %>%
inner_join(olympics%>%
filter(!is.na(medal)),
by = "team") %>%
mutate(team = fct_reorder(team, -n),
medal = fct_rev(fct_relevel(medal, "Gold", "Silver"))) %>%
count(team, medal, sort = TRUE) %>%
ggplot(aes(n, medal, fill = medal)) +
geom_col(show.legend = FALSE) +
facet_wrap(~team) +
scale_fill_manual(values = c("#B0413E", "#88A096", "#FCA311"))
olympics %>%
count(year, season) %>%
ggplot(aes(year, n, color = season)) +
geom_line(size = 1.5) +
scale_color_manual(values = c(o_yellow, o_blue)) +
theme(plot.title = element_markdown(lineheight = 1.1),
legend.position = "none") +
labs(x = "",
y = "# of athletes",
title = paste0("**Olympic Athletes**<br>
<span style='font-size:11pt'><span style='color:", o_yellow, ";'>**Summer**</span> vs. <span style='font-size:11pt'><span style='color:", o_blue,  ";'>**Winter**</span> Seasons"),
caption = tt_caption)
o_gold <- "#FCA311"
o_silver <- "#88A096"
o_bronze <- "#B0413E"
olympics %>%
filter(!is.na(medal)) %>%
count(team) %>%
top_n(9, n) %>%
inner_join(olympics%>%
filter(!is.na(medal)),
by = "team") %>%
mutate(team = fct_reorder(team, -n),
medal = fct_rev(fct_relevel(medal, "Gold", "Silver"))) %>%
count(team, medal, sort = TRUE) %>%
ggplot(aes(n, medal, fill = medal)) +
geom_col(show.legend = FALSE) +
facet_wrap(~team) +
scale_fill_manual(values = c(o_gold, "#88A096", "#FCA311"))
olympics %>%
filter(!is.na(medal)) %>%
count(team) %>%
top_n(9, n) %>%
inner_join(olympics%>%
filter(!is.na(medal)),
by = "team") %>%
mutate(team = fct_reorder(team, -n),
medal = fct_rev(fct_relevel(medal, "Gold", "Silver"))) %>%
count(team, medal, sort = TRUE) %>%
ggplot(aes(n, medal, fill = medal)) +
geom_col(show.legend = FALSE) +
facet_wrap(~team) +
scale_fill_manual(values = c(o_bronze, o_silver, o_gold))
olympics %>%
filter(!is.na(medal)) %>%
count(team) %>%
top_n(9, n) %>%
inner_join(olympics%>%
filter(!is.na(medal)),
by = "team") %>%
mutate(team = fct_reorder(team, -n),
medal = fct_relevel(medal, "Gold", "Silver")) %>%
count(year, team, medal) %>%
group_by(team, medal) %>%
mutate(counter = cumsum(n)) %>%
ungroup() %>%
ggplot(aes(year, counter, color = medal)) +
geom_step() +
facet_wrap(~team, scales = "free_y") +
scale_color_manual(values = c(o_bronze, o_silver, o_gold)) +
theme(plot.title = element_markdown(lineheight = 1.1),
legend.position = "none") +
labs(x = "",
y = "# of medals",
title = paste0("**Olympic Medals - Top 9 Countries**<br>
<span style='font-size:11pt'><span style='color:", o_yellow, ";'>**Summer**</span> vs. <span style='font-size:11pt'><span style='color:", o_blue,  ";'>**Winter**</span> Seasons"),
caption = tt_caption)
olympics %>%
filter(!is.na(medal)) %>%
count(team) %>%
top_n(9, n) %>%
inner_join(olympics%>%
filter(!is.na(medal)),
by = "team") %>%
mutate(team = fct_reorder(team, -n),
medal = fct_relevel(medal, "Gold", "Silver")) %>%
count(year, team, medal) %>%
group_by(team, medal) %>%
mutate(counter = cumsum(n)) %>%
ungroup() %>%
ggplot(aes(year, counter, color = medal)) +
geom_step() +
facet_wrap(~team, scales = "free_y") +
scale_color_manual(values = c(o_gold, o_silver, o_bronze)) +
theme(plot.title = element_markdown(lineheight = 1.1),
legend.position = "none") +
labs(x = "",
y = "# of medals",
title = paste0("**Olympic Medals - Top 9 Countries**<br>
<span style='font-size:11pt'><span style='color:", o_yellow, ";'>**Summer**</span> vs. <span style='font-size:11pt'><span style='color:", o_blue,  ";'>**Winter**</span> Seasons"),
caption = tt_caption)
olympics %>%
filter(!is.na(medal)) %>%
count(team) %>%
top_n(9, n) %>%
inner_join(olympics%>%
filter(!is.na(medal)),
by = "team") %>%
mutate(team = fct_reorder(team, -n),
medal = fct_relevel(medal, "Gold", "Silver")) %>%
count(year, team, medal) %>%
group_by(team, medal) %>%
mutate(counter = cumsum(n)) %>%
ungroup() %>%
ggplot(aes(year, counter, color = medal)) +
geom_step() +
facet_wrap(~team, scales = "free_y") +
scale_color_manual(values = c(o_gold, o_silver, o_bronze)) +
theme(plot.title = element_markdown(lineheight = 1.1),
legend.position = "none") +
labs(x = "",
y = "# of medals",
title = paste0("**Olympic Medals - Top 9 Countries**<br>
<span style='font-size:11pt'><span style='color:", o_gold, ";'>**Gold**</span> vs. <span style='font-size:11pt'><span style='color:", o_silver,  ";'>**Silver**</span> Seasons <span style='font-size:11pt'><span style='color:", o_silver,  ";'>**Bronnze**</span> medals"),
caption = tt_caption)
olympics %>%
filter(!is.na(medal)) %>%
count(team) %>%
top_n(9, n) %>%
inner_join(olympics%>%
filter(!is.na(medal)),
by = "team") %>%
mutate(team = fct_reorder(team, -n),
medal = fct_relevel(medal, "Gold", "Silver")) %>%
count(year, team, medal) %>%
group_by(team, medal) %>%
mutate(counter = cumsum(n)) %>%
ungroup() %>%
ggplot(aes(year, counter, color = medal)) +
geom_step() +
facet_wrap(~team, scales = "free_y") +
scale_color_manual(values = c(o_gold, o_silver, o_bronze)) +
theme(plot.title = element_markdown(lineheight = 1.1),
legend.position = "none") +
labs(x = "",
y = "# of medals",
title = paste0("**Olympic Medals - Top 9 Countries**<br>
<span style='font-size:11pt'><span style='color:", o_gold, ";'>**Gold**</span> vs. <span style='font-size:11pt'><span style='color:", o_silver,  ";'>**Silver**</span> Seasons <span style='font-size:11pt'><span style='color:", o_bronze,  ";'>**Bronnze**</span> medals"),
caption = tt_caption)
olympics %>%
filter(!is.na(medal)) %>%
count(team) %>%
top_n(9, n) %>%
inner_join(olympics%>%
filter(!is.na(medal)),
by = "team") %>%
mutate(team = fct_reorder(team, -n),
medal = fct_relevel(medal, "Gold", "Silver")) %>%
count(year, team, medal) %>%
group_by(team, medal) %>%
mutate(counter = cumsum(n)) %>%
ungroup() %>%
ggplot(aes(year, counter, color = medal)) +
geom_step() +
facet_wrap(~team, scales = "free_y") +
scale_color_manual(values = c(o_gold, o_silver, o_bronze)) +
theme(plot.title = element_markdown(lineheight = 1.1),
legend.position = "none") +
labs(x = "",
y = "# of medals",
title = paste0("**Olympic Medals - Top 9 Countries**<br>
The journey to<span style='font-size:11pt'><span style='color:", o_gold, ";'>**Gold**</span> , <span style='font-size:11pt'><span style='color:", o_silver,  ";'>**Silver**</span> , and <span style='font-size:11pt'><span style='color:", o_bronze,  ";'>**Bronze**</span> medal counts"),
caption = tt_caption)
olympics %>%
filter(!is.na(medal)) %>%
count(team) %>%
top_n(9, n) %>%
inner_join(olympics%>%
filter(!is.na(medal)),
by = "team") %>%
mutate(team = fct_reorder(team, -n),
medal = fct_relevel(medal, "Gold", "Silver")) %>%
count(year, team, medal) %>%
group_by(team, medal) %>%
mutate(counter = cumsum(n)) %>%
ungroup() %>%
ggplot(aes(year, counter, color = medal)) +
geom_step() +
facet_wrap(~team, scales = "free_y") +
scale_color_manual(values = c(o_gold, o_silver, o_bronze)) +
theme(plot.title = element_markdown(lineheight = 1.1),
legend.position = "none") +
labs(x = "",
y = "# of medals",
title = paste0("**Olympic Medals - Top 9 Countries**<br>
<span style='font-size:11pt'>The journey to<span style='color:", o_gold, ";'>**Gold**</span> , <span style='font-size:11pt'><span style='color:", o_silver,  ";'>**Silver**</span> , and <span style='font-size:11pt'><span style='color:", o_bronze,  ";'>**Bronze**</span> medal counts"),
caption = tt_caption)
olympics %>%
filter(!is.na(medal)) %>%
count(team) %>%
top_n(9, n) %>%
inner_join(olympics%>%
filter(!is.na(medal)),
by = "team") %>%
mutate(team = fct_reorder(team, -n),
medal = fct_relevel(medal, "Gold", "Silver")) %>%
count(year, team, medal) %>%
group_by(team, medal) %>%
mutate(counter = cumsum(n)) %>%
ungroup() %>%
ggplot(aes(year, counter, color = medal)) +
geom_step() +
facet_wrap(~team, scales = "free_y") +
scale_color_manual(values = c(o_gold, o_silver, o_bronze)) +
theme(plot.title = element_markdown(lineheight = 1.1),
legend.position = "none") +
labs(x = "",
y = "# of medals",
title = paste0("**Olympic Medals - Top 9 Countries**<br>
<span style='font-size:11pt'>The journey to <span style='color:", o_gold, ";'>**Gold**</span> , <span style='font-size:11pt'><span style='color:", o_silver,  ";'>**Silver**</span> , and <span style='font-size:11pt'><span style='color:", o_bronze,  ";'>**Bronze**</span> medal counts"),
caption = tt_caption)
olympics %>%
filter(!is.na(medal)) %>%
count(team) %>%
top_n(9, n) %>%
inner_join(olympics%>%
filter(!is.na(medal)),
by = "team") %>%
mutate(team = fct_reorder(team, -n),
medal = fct_relevel(medal, "Gold", "Silver")) %>%
count(year, team, medal) %>%
group_by(team, medal) %>%
mutate(counter = cumsum(n)) %>%
ungroup() %>%
ggplot(aes(year, counter, color = medal)) +
geom_step() +
facet_wrap(~team, scales = "free_y") +
scale_color_manual(values = c(o_gold, o_silver, o_bronze)) +
theme(plot.title = element_markdown(lineheight = 1.1),
legend.position = "none") +
labs(x = "",
y = "# of medals",
title = paste0("**Olympic Medals - Top 9 Countries**<br>
<span style='font-size:11pt'>The journey to <span style='color:", o_gold, ";'>**Gold**</span>, <span style='font-size:11pt'><span style='color:", o_silver,  ";'>**Silver**</span>, and <span style='font-size:11pt'><span style='color:", o_bronze,  ";'>**Bronze**</span> medal counts"),
caption = tt_caption)
# This will save your most recent plot
ggsave(
filename = "2021_07_27_tidy_tuesday.png",
device = "png")
olympics %>%
filter(!is.na(medal)) %>%
count(team) %>%
top_n(9, n) %>%
inner_join(olympics%>%
filter(!is.na(medal)),
by = "team") %>%
mutate(team = fct_reorder(team, -n),
medal = fct_relevel(medal, "Gold", "Silver")) %>%
count(year, team, medal) %>%
group_by(team, medal) %>%
mutate(counter = cumsum(n)) %>%
ungroup() %>%
ggplot(aes(year, counter, color = medal)) +
geom_step() +
facet_wrap(~team, scales = "free_y") +
scale_color_manual(values = c(o_gold, o_silver, o_bronze)) +
theme(plot.title = element_markdown(lineheight = 1.1),
legend.position = "none") +
labs(x = "",
y = "# of medals",
title = paste0("**Olympic Medals - Top 9 Countries**<br>
<span style='font-size:11pt'>The journey to <span style='color:", o_gold, ";'>**Gold**</span>, <span style='font-size:11pt'><span style='color:", o_silver,  ";'>**Silver**</span>, and <span style='font-size:11pt'><span style='color:", o_bronze,  ";'>**Bronze**</span> all-time medal counts"),
caption = tt_caption)
