hovertemplate = glue::glue(
"<b>{women2$labels}</b><br>",
"<b>Country: {women2$country}</b><br>",
"<b>Role: {women2$role}</b><br>",
"{women2$description2}",
"<extra></extra>"),
marker = list(colors = ~colors)
) %>%
layout(title = list(text = "<b>The BBC's 100 women of 2020</b>")) %>%
layout(paper_bgcolor='rgba(60,174,163,1)')
fig
# Chunk 1: setup
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(tidytuesdayR)
library(janitor)
library(scales)
theme_set(theme_light())
# Chunk 2: Load
tt <- tt_load("2021-01-19")
# Chunk 3: Readme
tt
# Chunk 4: Glimpse
tt %>%
map(glimpse)
# Chunk 5: Wrangle
gender <- tt$gender %>%
clean_names() %>%
filter(county != "Total") %>%
select(-intersex) %>%
mutate(county = ifelse(county == "Nairobi City", "Nairobi", county),
sub_county = str_to_upper(str_replace_all(county, " ", "")),
pct_male = male/total,
pct_female = female/total)
crops <- tt$crops %>%
clean_names() %>%
mutate(sub_county = str_replace_all(sub_county, " ", ""))
households <- tt$households %>%
clean_names() %>%
mutate(county = str_trim(county),
county = ifelse(county == "NairobiCity", "Nairobi", county),
sub_county = str_to_upper(county))
census <- gender %>%
inner_join(crops, by = "sub_county") %>%
inner_join(households %>% select(-county), by = "sub_county")
# Chunk 6: Visualize
census %>%
top_n(10, wt = -pct_female) %>%
mutate(county = fct_reorder(county, pct_female)) %>%
ggplot(aes(pct_female, county, fill = county)) +
geom_col(show.legend = FALSE) +
scale_x_continuous(labels = percent_format()) +
labs(x = "% female",
y = "",
title = "Kenya Census",
subtitle = "10 counties with lowest percentage of females",
caption = "Source: rKenyaCensus  |  Analysis: Tony Galvan (@GDataScience1)")
census %>%
top_n(10, wt = pct_female) %>%
mutate(county = fct_reorder(county, pct_female)) %>%
ggplot(aes(pct_female, county, fill = county)) +
geom_col(show.legend = FALSE) +
scale_x_continuous(labels = percent_format()) +
labs(x = "% female",
y = "",
title = "Kenya Census",
subtitle = "10 counties with highest percentage of females",
caption = "Source: rKenyaCensus  |  Analysis: Tony Galvan (@GDataScience1)")
census %>%
top_n(10, wt = average_household_size) %>%
mutate(county = fct_reorder(county, average_household_size)) %>%
ggplot(aes(average_household_size, county, fill = county)) +
geom_col(show.legend = FALSE) +
labs(x = "Average household size",
y = "",
title = "Kenya Census",
subtitle = "10 counties with the largest average household size",
caption = "Source: rKenyaCensus  |  Analysis: Tony Galvan (@GDataScience1)")
census %>%
ggplot(aes(pct_female, average_household_size)) +
geom_point(aes(size = farming)) +
geom_smooth(method = "lm", se = FALSE)
crops %>%
filter(sub_county == "KENYA") %>%
pivot_longer(cols = farming:khat_miraa, names_to = "crop", values_to = "pop_growing") %>%
filter(crop != "farming") %>%
mutate(crop = str_to_title(str_replace(crop, "_", " ")),
crop = fct_reorder(crop, pop_growing)) %>%
ggplot(aes(pop_growing, crop, fill = crop)) +
geom_col(show.legend = FALSE) +
scale_x_continuous(labels = comma_format()) +
expand_limits(x = c(0,1050000)) +
labs(x = "# of people growing the crop",
y = "",
title = "Kenya Crops",
subtitle = "Avocados and mangos are grown by the most people",
caption = "Source: rKenyaCensus  |  Analysis: Tony Galvan (@GDataScience1)")
# Chunk 7
# This will save your most recent plot
ggsave(
filename = "gdatascience1_202104.png",
device = "png",
width = 5)
# Chunk 1: setup
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(tidytuesdayR)
library(janitor)
library(scales)
# Chunk 2: Load
tt <- tt_load("2021-02-02")
# Chunk 3: Readme
tt
# Chunk 4: Glimpse
tt %>%
map(glimpse)
# Chunk 5: Wrangle
summary(tt)
hbcu_all <- tt$hbcu_all %>% clean_names()
hbcu_black <- tt$hbcu_black %>% clean_names()
hbcu <- hbcu_all %>%
mutate(enrollment = "All") %>%
rbind(hbcu_black %>%
mutate(enrollment = "Black"))
pct_hbcu <- hbcu %>%
select(year, enrollment, total_enrollment) %>%
pivot_wider(names_from = enrollment, values_from = total_enrollment) %>%
mutate(pct_black = Black / All)
# Chunk 6: Visualize
pct_hbcu %>%
ggplot(aes(year, pct_black)) +
geom_line(size = 1.25, color = "white") +
#geom_hline(yintercept = 0.7946721, lty = 2, color = "#d2d2d2") +
scale_y_continuous(labels = percent_format(accuracy = 1)) +
labs(x = "",
y = "% of total enrollment",
title = "Historically Black Colleges & Universities",
subtitle = "2014-15: Percentage of black enrollees is the lowest since 1984",
caption = "Source: National Center for Education Statistics | Analysis: Tony Galvan (@GDataScience1)") +
theme(panel.grid.major.x = element_blank(),
panel.grid.minor = element_blank(),
panel.grid.major.y = element_blank(),
axis.ticks = element_blank(),
panel.background = element_rect("#5a5a5a"),
plot.background = element_rect(fill = "#5a5a5a"),
axis.title.y = element_text(color = "#d2d2d2", size = 12),
axis.text.y = element_text(color="#d2d2d2", size=10),
axis.text.x = element_text(color = "#d2d2d2", size = 10),
plot.title = element_text(color = "white", size = 16, face = "bold"),
plot.subtitle = element_text(color = "#d2d2d2", size = 14),
plot.caption = element_text(color = "#d2d2d2", size = 8))
# Chunk 7
# This will save your most recent plot
ggsave(
filename = "2021_02_02_tidy_tuesday.png",
device = "png")
# This will save your most recent plot
ggsave(
filename = "2021_02_02_tidy_tuesday.png",
device = "png",
width = 640,
height = 510)
# This will save your most recent plot
ggsave(
filename = "2021_02_02_tidy_tuesday.png",
device = "png",
width = 6.4,
height = 5.1)
# This will save your most recent plot
ggsave(
filename = "2021_02_02_tidy_tuesday.png",
device = "png",
width = 6.4,
height = 5.1)
install.packages("ggtext")
setwd("~/GitHub/tidytuesday/2021")
tidytuesdayR::use_tidytemplate()
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(tidytuesdayR)
library(scales)
tt <- tt_load("2021-02-09")
home_owner <- tt$home_owner
home_owner %>%
ggplot(aes(year, home_owner_pct, color = race)) +
geom_line() +
scale_y_continuous(labels = percent) +
theme(legend.position = "top") +
labs(x = "",
y = "% home owners",
color = "Race",
title = "Home Ownership started declining in 2005",
subtitle = "Hispanic home ownership declined less",
caption = tt_caption)
home_owner %>%
ggplot(aes(year, home_owner_pct, color = race)) +
geom_line() +
scale_y_continuous(labels = percent) +
theme(legend.position = "top") +
labs(x = "",
y = "% home owners",
color = "Race",
title = "Home Ownership started declining in 2005",
subtitle = "Hispanic home ownership declined less",
caption = "Source: Urban Institute & US Census  |  Analysis: Tony Galvan (@GDataScience1)")
names_from = "year",
values_from = home_owner_pct,
names_prefix = "year_") %>%
mutate(change_since_2005 = year_2005 - year_2016,
change_string = paste0("-", round(change_since_2005 * 100, 1), "%"),
year = 2016) %>%
select(-year_2005, -year_2016)
glimpse(since_2015)
since_2015 <- home_owner %>%
filter(year %in% c(2005, 2016)) %>%
pivot_wider(names_from = "year",
values_from = home_owner_pct,
names_prefix = "year_") %>%
mutate(change_since_2005 = year_2005 - year_2016,
change_string = paste0("-", round(change_since_2005 * 100, 1), "%"),
year = 2016) %>%
select(-year_2005, -year_2016)
glimpse(since_2015)
p1 <- home_owner %>%
filter(year >= 2005) %>%
left_join(since_2015, by = c("year", "race")) %>%
mutate(race = fct_reorder(race, -home_owner_pct)) %>%
ggplot(aes(year, home_owner_pct, color = race)) +
geom_line(size = 1) +
scale_color_manual(values = c("#0072B2", "#D55E00", "#009E73")) +
scale_y_continuous(labels = percent) +
theme(legend.position = "top")
p1
p2 <- p1 +
geom_text(aes(label = change_string),
show.legend = FALSE,
fontface = 2,
#hjust = 0,
nudge_x = 0.75) +
scale_x_continuous(limits = c(2005, 2017), breaks = c(2005, 2016))
p2
library(ggtext)
p3 <- p2  +
labs(x = "",
y = "% home owners",
color = "Race",
title = "Home Ownership started declining in 2005",
subtitle = "Hispanic home ownership declined less (vs. <span style='color:#0072B2;'>White</span> & <span style='color:#009E73;'>Black</span>)",
caption = tt_caption)
p3 <- p2  +
labs(x = "",
y = "% home owners",
color = "Race",
title = "Home Ownership started declining in 2005",
subtitle = "Hispanic home ownership declined less (vs. <span style='color:#0072B2;'>White</span> & <span style='color:#009E73;'>Black</span>)",
caption = "Source: Urban Institute & US Census  |  Analysis: Tony Galvan (@GDataScience1)")
p3
p3 <- p2  +
theme(plot.title = element_markdown(lineheight = 1.1),
legend.text = element_markdown(size = 11)) +
labs(x = "",
y = "% home owners",
color = "Race",
title = "Home Ownership started declining in 2005",
subtitle = "Hispanic home ownership declined less (vs. <span style='color:#0072B2;'>White</span> & <span style='color:#009E73;'>Black</span>)",
caption = "Source: Urban Institute & US Census  |  Analysis: Tony Galvan (@GDataScience1)")
p3
p3 <- p2  +
theme(plot.title = element_markdown(lineheight = 1.1),
legend.text = element_markdown(size = 11)) +
labs(x = "",
y = "% home owners",
color = "Race",
title = "Home Ownership started declining in 2005",
subtitle = "**Hispanic home ownership declined less (vs. <span style='color:#0072B2;'>White</span> & <span style='color:#009E73;'>Black</span>)**",
caption = "Source: Urban Institute & US Census  |  Analysis: Tony Galvan (@GDataScience1)")
p3
p3 <- p2  +
theme(plot.title = element_markdown(lineheight = 1.1),
legend.text = element_markdown(size = 11)) +
labs(x = "",
y = "% home owners",
color = "Race",
subtitle = "Home Ownership started declining in 2005",
title = "**Hispanic home ownership declined less (vs. <span style='color:#0072B2;'>White</span> & <span style='color:#009E73;'>Black</span>)**",
caption = "Source: Urban Institute & US Census  |  Analysis: Tony Galvan (@GDataScience1)")
p3
p3 <- p2  +
theme(plot.title = element_markdown(lineheight = 1.1),
legend.text = element_markdown(size = 11)) +
labs(x = "",
y = "% home owners",
color = "Race",
title = "**Home Ownership started declining in 2005**\nHispanic home ownership declined less (vs. <span style='color:#0072B2;'>White</span> & <span style='color:#009E73;'>Black</span>)**",
caption = "Source: Urban Institute & US Census  |  Analysis: Tony Galvan (@GDataScience1)")
p3 <- p2  +
theme(plot.title = element_markdown(lineheight = 1.1),
legend.text = element_markdown(size = 11)) +
labs(x = "",
y = "% home owners",
color = "Race",
title = "**Home Ownership started declining in 2005**\nHispanic home ownership declined less (vs. <span style='color:#0072B2;'>White</span> & <span style='color:#009E73;'>Black</span>)**",
caption = "Source: Urban Institute & US Census  |  Analysis: Tony Galvan (@GDataScience1)")
p3
p3 <- p2  +
theme(plot.title = element_markdown(lineheight = 1.1),
legend.text = element_markdown(size = 11)) +
labs(x = "",
y = "% home owners",
color = "Race",
title = "**Home Ownership started declining in 2005**
<span style='font-size:11pt'>Hispanic home ownership declined less (vs. <span style='color:#0072B2;'>White</span> & <span style='color:#009E73;'>Black</span>)</span>",
caption = "Source: Urban Institute & US Census  |  Analysis: Tony Galvan (@GDataScience1)")
p3 <- p2  +
theme(plot.title = element_markdown(lineheight = 1.1),
legend.text = element_markdown(size = 11)) +
labs(x = "",
y = "% home owners",
color = "Race",
title = "**Home Ownership started declining in 2005**
<span style='font-size:11pt'>Hispanic home ownership declined less (vs. <span style='color:#0072B2;'>White</span> & <span style='color:#009E73;'>Black</span>)</span>",
caption = "Source: Urban Institute & US Census  |  Analysis: Tony Galvan (@GDataScience1)")
p3
p3 <- p2  +
theme(plot.title = element_markdown(lineheight = 1.1),
legend.text = element_markdown(size = 11)) +
labs(x = "",
y = "% home owners",
color = "Race",
title = "**Home Ownership started declining in 2005**<br>
<span style='font-size:11pt'>Hispanic home ownership declined less (vs. <span style='color:#0072B2;'>White</span> & <span style='color:#009E73;'>Black</span>)</span>",
caption = "Source: Urban Institute & US Census  |  Analysis: Tony Galvan (@GDataScience1)")
p3
p3 <- p2  +
theme(plot.title = element_markdown(lineheight = 1.1),
legend.text = element_markdown(size = 11)) +
labs(x = "",
y = "% home owners",
color = "Race",
title = "**Home Ownership started declining in 2005**<br>
<span style='font-size:11pt'><span style='color:#D55E00;'>Hispanic</span> home ownership declined less (vs. <span style='color:#0072B2;'>White</span> & <span style='color:#009E73;'>Black</span>)</span>",
caption = "Source: Urban Institute & US Census  |  Analysis: Tony Galvan (@GDataScience1)")
p3
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(tidytuesdayR)
library(janitor)
library(scales)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(tidytuesdayR)
library(janitor)
library(scales)
tt <- tt_load("2021-02-02")
tt
summary(tt)
hbcu_all <- tt$hbcu_all %>% clean_names()
hbcu_black <- tt$hbcu_black %>% clean_names()
hbcu <- hbcu_all %>%
mutate(enrollment = "All") %>%
bind_rows(hbcu_black %>%
mutate(enrollment = "Black"))
pct_hbcu <- hbcu %>%
select(year, enrollment, total_enrollment) %>%
pivot_wider(names_from = enrollment, values_from = total_enrollment) %>%
mutate(pct_black = Black / All)
pct_hbcu %>%
ggplot(aes(year, pct_black)) +
geom_line(size = 1.25, color = "white") +
#geom_hline(yintercept = 0.7946721, lty = 2, color = "#d2d2d2") +
scale_y_continuous(labels = percent_format(accuracy = 1)) +
labs(x = "",
y = "% of total enrollment",
title = "Historically Black Colleges & Universities",
subtitle = "2014-15: Percentage of black enrollees is the lowest since 1984",
caption = "Source: National Center for Education Statistics | Analysis: Tony Galvan (@GDataScience1)") +
theme(panel.grid.major.x = element_blank(),
panel.grid.minor = element_blank(),
panel.grid.major.y = element_blank(),
axis.ticks = element_blank(),
panel.background = element_rect("#5a5a5a"),
plot.background = element_rect(fill = "#5a5a5a"),
axis.title.y = element_text(color = "#d2d2d2", size = 12),
axis.text.y = element_text(color="#d2d2d2", size=10),
axis.text.x = element_text(color = "#d2d2d2", size = 10),
plot.title = element_text(color = "white", size = 16, face = "bold"),
plot.subtitle = element_text(color = "#d2d2d2", size = 14),
plot.caption = element_text(color = "#d2d2d2", size = 8))
View(hbcu_all)
View(hbcu_black)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(scales)
library(tidytuesdayR)
tt <- tt_load("2021-02-09")
tt
tt %>%
map(glimpse)
home_owner <- tt$home_owner
View(home_owner)
summary(home_owner$year)
home_owner %>%
count(year, race)
home_owner %>%
count(year)
home_owner %>%
count(year) %>%
filter(n < 3)
home_owner %>%
ggplot(aes(year, home_owner_pct, color = race)) +
geom_line()
since_2015 <- home_owner %>%
filter(year %in% c(2005, 2016)) %>%
pivot_wider(names_from = "year",
values_from = home_owner_pct,
names_prefix = "year_") %>%
mutate(change_since_2005 = year_2005 - year_2016,
change_string = paste0("-", round(change_since_2005 * 100, 1), "%"),
year = 2016) %>%
select(-year_2005, -year_2016)
glimpse(since_2015)
home_owner %>%
filter(year %in% c(2005, 2016)) %>%
pivot_wider(names_from = "year",
values_from = home_owner_pct,
names_prefix = "year_")
View(since_2015)
p1 <- home_owner %>%
filter(year >= 2005) %>%
left_join(since_2015, by = c("year", "race")) %>%
mutate(race = fct_reorder(race, -home_owner_pct)) %>%
ggplot(aes(year, home_owner_pct, color = race)) +
geom_line(size = 1) +
scale_color_manual(values = c("#0072B2", "#D55E00", "#009E73")) +
scale_y_continuous(labels = percent) +
theme(legend.position = "top")
p1
p2 <- p1 +
geom_text(aes(label = change_string),
show.legend = FALSE,
fontface = 2,
#hjust = 0,
nudge_x = 0.75) +
scale_x_continuous(limits = c(2005, 2017), breaks = c(2005, 2016))
p2
library(ggtext)
p3 <- p2  +
theme(plot.title = element_markdown(lineheight = 1.1),
legend.text = element_markdown(size = 11)) +
labs(x = "",
y = "% home owners",
color = "Race",
title = "**Home Ownership started declining in 2005**<br>
<span style='font-size:11pt'><span style='color:#D55E00;'>Hispanic</span> home ownership declined less (vs. <span style='color:#0072B2;'>White</span> & <span style='color:#009E73;'>Black</span>)</span>",
caption = "Source: Urban Institute & US Census  |  Analysis: Tony Galvan (@GDataScience1)")
p3
View(tt)
student_debt <- tt$student_debt
View(student_debt)
summary(student_debt$year)
student_debt %>%
count(year)
View(student_debt)
p4 <- student_debt %>%
ggplot(aes(year, loan_debt_pct, color = race)) +
geom_point()
p4
p4 <- student_debt %>%
ggplot(aes(year, loan_debt_pct, color = race)) +
geom_line()
p4
p4 <- student_debt %>%
ggplot(aes(year, loan_debt_pct, color = race)) +
geom_point() +
geom_smooth(method = "loess", se = FALSE)
p4
p3
p3 <- p2  +
theme(plot.title = element_markdown(lineheight = 1.1),
#legend.text = element_markdown(size = 11)
legend.position = "none") +
labs(x = "",
y = "% home owners",
color = "Race",
title = "**Home Ownership started declining in 2005**<br>
<span style='font-size:11pt'><span style='color:#D55E00;'>Hispanic</span> home ownership declined less (vs. <span style='color:#0072B2;'>White</span> & <span style='color:#009E73;'>Black</span>)</span>",
caption = "Source: Urban Institute & US Census  |  Analysis: Tony Galvan (@GDataScience1)")
p3
p3 <- p2  +
theme(plot.title = element_markdown(lineheight = 1.1),
#legend.text = element_markdown(size = 11)
legend.position = "none") +
labs(x = "",
y = "% home owners",
color = "Race",
title = "**Home Ownership started declining in 2005**<br>
<span style='font-size:11pt'><span style='color:#D55E00;'>**Hispanic**</span> home ownership declined less (vs. <span style='color:#0072B2;'>**White**</span> & <span style='color:#009E73;'>**Black**</span>)</span>",
caption = "Source: Urban Institute & US Census  |  Analysis: Tony Galvan (@GDataScience1)")
p3
# This will save your most recent plot
ggsave(
filename = "2021_02_09_tidy_tuesday.png",
device = "png")
p3
# This will save your most recent plot
ggsave(
filename = "2021_02_09_tidy_tuesday.png",
device = "png")
# This will save your most recent plot
ggsave(
filename = "2021_02_09_tidy_tuesday.png",
device = "png")
