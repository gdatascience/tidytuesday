un_votes %>%
group_by(country) %>%
summarize(n = n(),
vote_yes = sum(ifelse(vote == "yes", 1, 0)),
pct_yes_vote = vote_yes / n) %>%
ungroup() %>%
filter(n >= 3) %>%
top_n(10, -pct_yes_vote) %>%
mutate(country = fct_reorder(country, -pct_yes_vote),
fill = ifelse(country == "United States", "US", "Other")) %>%
ggplot(aes(pct_yes_vote, country, fill = fill)) +
geom_col(show.legend = FALSE) +
scale_x_continuous(labels = percent) +
scale_fill_manual(values = c("gray75", "#3C3B6E")) +
theme(plot.title = element_markdown(lineheight = 1.1)) +
labs(x = "% 'YES' votes",
y = "",
title = "**10 UN Countries with the lowest percentage of 'YES' votes**<br>
<span style='font-size:12pt'>The <span style='color:#3C3B6E;'>**United States**</span> has the lowest percentage of 'YES' votes</span>",
caption = "Source: Harvard Dataverse  |  Analysis: Tony Galvan (@GDataScience1)")
un_votes <- tt$unvotes %>%
left_join(tt$roll_calls, by = "rcid") %>%
left_join(tt$issues, by = "rcid") %>%
mutate(year = lubridate::year(date),
country = ifelse(str_detect(country, "Germany"), "Germany", country),
country = ifelse(str_detect(country, "Micronesia"), "Micronesia", country))
un_votes
un_votes %>%
count(country) %>%
ggplot(aes(n)) +
geom_histogram()
library(ggtext)
un_votes %>%
group_by(country) %>%
summarize(n = n(),
vote_yes = sum(ifelse(vote == "yes", 1, 0)),
pct_yes_vote = vote_yes / n) %>%
ungroup() %>%
filter(n >= 3) %>%
top_n(10, -pct_yes_vote) %>%
mutate(country = fct_reorder(country, -pct_yes_vote),
fill = ifelse(country == "United States", "US", "Other")) %>%
ggplot(aes(pct_yes_vote, country, fill = fill)) +
geom_col(show.legend = FALSE) +
scale_x_continuous(labels = percent) +
scale_fill_manual(values = c("gray75", "#3C3B6E")) +
theme(plot.title = element_markdown(lineheight = 1.1)) +
labs(x = "% 'YES' votes",
y = "",
title = "**10 UN Countries with the lowest percentage of 'YES' votes**<br>
<span style='font-size:12pt'>The <span style='color:#3C3B6E;'>**United States**</span> has the lowest percentage of 'YES' votes</span>",
caption = "Source: Harvard Dataverse  |  Analysis: Tony Galvan (@GDataScience1)")
# This will save your most recent plot
ggsave(
filename = "2021_03_23_tidy_tuesday.png",
device = "png")
iso3166 <- as_tibble(maps::iso3166)
iso3166
View(un_votes)
View(un_votes)
install.packages("fuzzyjoin")
map_data("world") %>%
as_tibble() %>%
filter(region != "Antarctica")
map_data("world") %>%
as_tibble() %>%
filter(region != "Antarctica") %>%
regex_left_join(un_votes %>%
inner_join(as_tibble(maps::iso3166),
by = c("contry_code" = "a2")),
by = c("region" = "mapname"))
library(fuzzyjoin)
map_data("world") %>%
as_tibble() %>%
filter(region != "Antarctica") %>%
regex_left_join(un_votes %>%
inner_join(as_tibble(maps::iso3166),
by = c("contry_code" = "a2")),
by = c("region" = "mapname"))
map_data("world") %>%
as_tibble() %>%
filter(region != "Antarctica") %>%
regex_left_join(un_votes %>%
inner_join(as_tibble(maps::iso3166),
by = c("country_code" = "a2")),
by = c("region" = "mapname"))
#library(ggmap)
#map.world <- map_data("world")
#map.world_joined <- left_join(map.world, un_votes, by = c('region' = 'country'))
library(fuzzyjoin)
map_data("world") %>%
as_tibble() %>%
filter(region != "Antarctica") %>%
regex_left_join(un_votes %>%
group_by(country, country_code) %>%
summarize(n = n(),
vote_yes = sum(ifelse(vote == "yes", 1, 0)),
pct_yes_vote = vote_yes / n) %>%
inner_join(as_tibble(maps::iso3166),
by = c("country_code" = "a2")),
by = c("region" = "mapname"))
map_data("world") %>%
as_tibble() %>%
filter(region != "Antarctica") %>%
regex_left_join(un_votes %>%
group_by(country, country_code) %>%
summarize(n = n(),
vote_yes = sum(ifelse(vote == "yes", 1, 0)),
pct_yes_vote = vote_yes / n) %>%
inner_join(as_tibble(maps::iso3166),
by = c("country_code" = "a2")),
by = c("region" = "mapname")) %>%
ggplot(aes(long, lat, group = group, fill = waste_per_capita)) +
geom_polygon() +
scale_fill_gradient2(trans = "log10",
low = "dark blue",
high = "orange",
mid = "grey",
midpoint = log10(0.02)) +
coord_fixed(2) +
ggthemes::theme_map() +
labs(fill = "% 'YES' votes",
title = "UN votes",
caption = "Source: Harvard Dataverse  |  Analysis: Tony Galvan (@GDataScience1)")
map_data("world") %>%
as_tibble() %>%
filter(region != "Antarctica") %>%
regex_left_join(un_votes %>%
group_by(country, country_code) %>%
summarize(n = n(),
vote_yes = sum(ifelse(vote == "yes", 1, 0)),
pct_yes_vote = vote_yes / n) %>%
inner_join(as_tibble(maps::iso3166),
by = c("country_code" = "a2")),
by = c("region" = "mapname")) %>%
ggplot(aes(long, lat, group = group, fill = pct_yes_vote)) +
geom_polygon() +
scale_fill_gradient2(low = "dark blue",
high = "orange",
mid = "grey",
midpoint = 0.5) +
coord_fixed(2) +
ggthemes::theme_map() +
labs(fill = "% 'YES' votes",
title = "UN votes",
caption = "Source: Harvard Dataverse  |  Analysis: Tony Galvan (@GDataScience1)")
map_data("world") %>%
as_tibble() %>%
filter(region != "Antarctica") %>%
regex_left_join(un_votes %>%
group_by(country, country_code) %>%
summarize(n = n(),
vote_yes = sum(ifelse(vote == "yes", 1, 0)),
pct_yes_vote = vote_yes / n) %>%
inner_join(as_tibble(maps::iso3166),
by = c("country_code" = "a2")),
by = c("region" = "mapname")) %>%
ggplot(aes(long, lat, group = group, fill = pct_yes_vote)) +
geom_polygon() +
scale_fill_gradient2(low = "dark blue",
high = "orange",
mid = "grey",
midpoint = 0.65) +
coord_fixed(2) +
ggthemes::theme_map() +
labs(fill = "% 'YES' votes",
title = "UN votes",
caption = "Source: Harvard Dataverse  |  Analysis: Tony Galvan (@GDataScience1)")
map_data("world") %>%
as_tibble() %>%
filter(region != "Antarctica") %>%
regex_left_join(un_votes %>%
group_by(country, country_code) %>%
summarize(n = n(),
vote_yes = sum(ifelse(vote == "yes", 1, 0)),
pct_yes_vote = vote_yes / n) %>%
inner_join(as_tibble(maps::iso3166),
by = c("country_code" = "a2")),
by = c("region" = "mapname")) %>%
ggplot(aes(long, lat, group = group, fill = pct_yes_vote)) +
geom_polygon() +
scale_fill_gradient2(low = "dark blue",
high = "orange",
mid = "grey",
midpoint = 0.65) +
coord_fixed(2) +
ggthemes::theme_map() +
labs(fill = "% 'YES' votes",
title = "UN countries: percent of 'YES' votes",
caption = "Source: Harvard Dataverse  |  Analysis: Tony Galvan (@GDataScience1)")
map_data("world") %>%
as_tibble() %>%
filter(region != "Antarctica") %>%
regex_left_join(un_votes %>%
group_by(country, country_code) %>%
summarize(n = n(),
vote_yes = sum(ifelse(vote == "yes", 1, 0)),
pct_yes_vote = vote_yes / n) %>%
inner_join(as_tibble(maps::iso3166),
by = c("country_code" = "a2")),
by = c("region" = "mapname")) %>%
ggplot(aes(long, lat, group = group, fill = pct_yes_vote)) +
geom_polygon() +
scale_fill_gradient2(low = "dark blue",
high = "orange",
mid = "grey",
midpoint = 0.65) +
#coord_fixed(2) +
ggthemes::theme_map() +
labs(fill = "% 'YES' votes",
title = "UN countries: percent of 'YES' votes",
caption = "Source: Harvard Dataverse  |  Analysis: Tony Galvan (@GDataScience1)")
library(ggtext)
un_votes %>%
group_by(country) %>%
summarize(n = n(),
vote_yes = sum(ifelse(vote == "yes", 1, 0)),
pct_yes_vote = vote_yes / n) %>%
ungroup() %>%
filter(n >= 3) %>%
top_n(10, -pct_yes_vote) %>%
mutate(country = fct_reorder(country, -pct_yes_vote),
fill = ifelse(country == "United States", "US", "Other")) %>%
ggplot(aes(pct_yes_vote, country, fill = fill)) +
geom_col(show.legend = FALSE) +
scale_x_continuous(labels = percent) +
scale_fill_manual(values = c("gray75", "#3C3B6E")) +
theme(plot.title = element_markdown(lineheight = 1.1)) +
labs(x = "% 'YES' votes",
y = "",
title = "**10 UN Countries with the lowest percentage of 'YES' votes**<br>
<span style='font-size:12pt'>The <span style='color:#3C3B6E;'>**United States**</span> has the lowest percentage of 'YES' votes</span>",
caption = "Source: Harvard Dataverse  |  Analysis: Tony Galvan (@GDataScience1)")
un_votes %>%
filter(!is.na(issue)) %>%
group_by(country, issue) %>%
summarize(n = n(),
vote_yes = sum(ifelse(vote == "yes", 1, 0)),
pct_yes_vote = vote_yes / n) %>%
ungroup() %>%
filter(n >= 250) %>%
group_by(issue) %>%
top_n(20, wt = n) %>%
ungroup() %>%
mutate(country = fct_reorder(country, -pct_yes_vote),
fill = ifelse(country == "United States", "US", "Other")) %>%
ggplot(aes(pct_yes_vote, country, fill = fill)) +
geom_col(show.legend = FALSE) +
scale_x_continuous(labels = percent) +
scale_fill_manual(values = c("gray75", "#3C3B6E")) +
facet_wrap(~issue, scale = "free_y") +
labs(x = "% 'YES' votes",
y = "",
title = "UN Countries with the 10 lowest percent of 'YES' votes",
subtitle = "The United States is lowest of countries with at least 4000 votes")
un_votes %>%
filter(!is.na(issue)) %>%
group_by(country, issue) %>%
summarize(n = n(),
vote_yes = sum(ifelse(vote == "yes", 1, 0)),
pct_yes_vote = vote_yes / n) %>%
ungroup() %>%
filter(n >= 250) %>%
group_by(issue) %>%
top_n(10, wt = -pct_yes_vote) %>%
ungroup() %>%
mutate(country = fct_reorder(country, -pct_yes_vote),
fill = ifelse(country == "United States", "US", "Other")) %>%
ggplot(aes(pct_yes_vote, country, fill = fill)) +
geom_col(show.legend = FALSE) +
scale_x_continuous(labels = percent) +
scale_fill_manual(values = c("gray75", "#3C3B6E")) +
facet_wrap(~issue, scale = "free_y") +
labs(x = "% 'YES' votes",
y = "",
title = "UN Countries with the 10 lowest percent of 'YES' votes",
subtitle = "The United States is lowest of countries with at least 4000 votes")
library(tidytext)
un_votes %>%
filter(!is.na(issue)) %>%
group_by(country, issue) %>%
summarize(n = n(),
vote_yes = sum(ifelse(vote == "yes", 1, 0)),
pct_yes_vote = vote_yes / n) %>%
ungroup() %>%
filter(n >= 250) %>%
group_by(issue) %>%
top_n(10, wt = -pct_yes_vote) %>%
ungroup() %>%
mutate(country = reorder_within(country, -pct_yes_vote, issue),
fill = ifelse(country == "United States", "US", "Other")) %>%
ggplot(aes(pct_yes_vote, country, fill = fill)) +
geom_col(show.legend = FALSE) +
scale_x_continuous(labels = percent) +
scale_y_reordered() +
scale_fill_manual(values = c("gray75", "#3C3B6E")) +
facet_wrap(~issue, scale = "free_y") +
labs(x = "% 'YES' votes",
y = "",
title = "UN Countries with the 10 lowest percent of 'YES' votes",
subtitle = "The United States is lowest of countries with at least 4000 votes")
un_votes %>%
filter(!is.na(issue)) %>%
group_by(country, issue) %>%
summarize(n = n(),
vote_yes = sum(ifelse(vote == "yes", 1, 0)),
pct_yes_vote = vote_yes / n) %>%
ungroup() %>%
filter(n >= 250) %>%
group_by(issue) %>%
top_n(10, wt = -pct_yes_vote) %>%
ungroup() %>%
mutate(country = reorder_within(country, -pct_yes_vote, issue),
fill = ifelse(country == "United States", "US", "Other")) %>%
ggplot(aes(pct_yes_vote, country, fill = fill)) +
geom_col(show.legend = FALSE) +
scale_x_continuous(labels = percent) +
scale_fill_manual(values = c("gray75", "#3C3B6E")) +
scale_y_reordered() +
facet_wrap(~issue, scale = "free_y") +
labs(x = "% 'YES' votes",
y = "",
title = "UN Countries with the 10 lowest percent of 'YES' votes",
subtitle = "The United States is lowest of countries with at least 4000 votes")
un_votes %>%
filter(!is.na(issue)) %>%
group_by(country, issue) %>%
summarize(n = n(),
vote_yes = sum(ifelse(vote == "yes", 1, 0)),
pct_yes_vote = vote_yes / n) %>%
ungroup() %>%
filter(n >= 250) %>%
group_by(issue) %>%
top_n(10, wt = -pct_yes_vote) %>%
ungroup() %>%
mutate(fill = ifelse(country == "United States", "US", "Other"),
country = reorder_within(country, -pct_yes_vote, issue)) %>%
ggplot(aes(pct_yes_vote, country, fill = fill)) +
geom_col(show.legend = FALSE) +
scale_x_continuous(labels = percent) +
scale_fill_manual(values = c("gray75", "#3C3B6E")) +
scale_y_reordered() +
facet_wrap(~issue, scale = "free_y") +
labs(x = "% 'YES' votes",
y = "",
title = "UN Countries with the 10 lowest percent of 'YES' votes",
subtitle = "The United States is lowest of countries with at least 4000 votes")
un_votes %>%
filter(!is.na(issue)) %>%
group_by(country, issue) %>%
summarize(n = n(),
vote_yes = sum(ifelse(vote == "yes", 1, 0)),
pct_yes_vote = vote_yes / n) %>%
ungroup() %>%
filter(n >= 250) %>%
group_by(issue) %>%
top_n(10, wt = -pct_yes_vote) %>%
ungroup() %>%
mutate(fill = ifelse(country == "United States", "US", "Other"),
country = reorder_within(country, -pct_yes_vote, issue)) %>%
ggplot(aes(pct_yes_vote, country, fill = fill)) +
geom_col(show.legend = FALSE) +
scale_x_continuous(labels = percent) +
scale_fill_manual(values = c("gray75", "#3C3B6E")) +
scale_y_reordered() +
facet_wrap(~issue, scale = "free_y") +
labs(x = "% 'YES' votes",
y = "",
title = ""**10 UN Countries with the lowest percentage of 'YES' votes by issue**<br>
un_votes %>%
filter(!is.na(issue)) %>%
group_by(country, issue) %>%
summarize(n = n(),
vote_yes = sum(ifelse(vote == "yes", 1, 0)),
pct_yes_vote = vote_yes / n) %>%
ungroup() %>%
filter(n >= 250) %>%
group_by(issue) %>%
top_n(10, wt = -pct_yes_vote) %>%
ungroup() %>%
mutate(fill = ifelse(country == "United States", "US", "Other"),
country = reorder_within(country, -pct_yes_vote, issue)) %>%
ggplot(aes(pct_yes_vote, country, fill = fill)) +
geom_col(show.legend = FALSE) +
scale_x_continuous(labels = percent) +
scale_fill_manual(values = c("gray75", "#3C3B6E")) +
scale_y_reordered() +
facet_wrap(~issue, scale = "free_y") +
labs(x = "% 'YES' votes",
y = "",
title = "**10 UN Countries with the lowest percentage of 'YES' votes**<br>
<span style='font-size:12pt'>The <span style='color:#3C3B6E;'>**United States**</span> has the lowest percentage of 'YES' votes in 4 out of the 6 issues</span>",
caption = "Source: Harvard Dataverse  |  Analysis: Tony Galvan (@GDataScience1)")
un_votes %>%
filter(!is.na(issue)) %>%
group_by(country, issue) %>%
summarize(n = n(),
vote_yes = sum(ifelse(vote == "yes", 1, 0)),
pct_yes_vote = vote_yes / n) %>%
ungroup() %>%
filter(n >= 250) %>%
group_by(issue) %>%
top_n(10, wt = -pct_yes_vote) %>%
ungroup() %>%
mutate(fill = ifelse(country == "United States", "US", "Other"),
country = reorder_within(country, -pct_yes_vote, issue)) %>%
ggplot(aes(pct_yes_vote, country, fill = fill)) +
geom_col(show.legend = FALSE) +
scale_x_continuous(labels = percent) +
scale_fill_manual(values = c("gray75", "#3C3B6E")) +
theme(plot.title = element_markdown(lineheight = 1.1)) +
scale_y_reordered() +
facet_wrap(~issue, scale = "free_y") +
labs(x = "% 'YES' votes",
y = "",
title = "**10 UN Countries with the lowest percentage of 'YES' votes**<br>
<span style='font-size:12pt'>The <span style='color:#3C3B6E;'>**United States**</span> has the lowest percentage of 'YES' votes in 4 out of the 6 issues</span>",
caption = "Source: Harvard Dataverse  |  Analysis: Tony Galvan (@GDataScience1)")
un_votes %>%
filter(!is.na(issue)) %>%
group_by(country, issue) %>%
summarize(n = n(),
vote_yes = sum(ifelse(vote == "yes", 1, 0)),
pct_yes_vote = vote_yes / n) %>%
ungroup() %>%
filter(n >= 250) %>%
group_by(issue) %>%
top_n(10, wt = -pct_yes_vote) %>%
ungroup() %>%
mutate(fill = ifelse(country == "United States", "US", "Other"),
country = reorder_within(country, -pct_yes_vote, issue)) %>%
ggplot(aes(pct_yes_vote, country, fill = fill)) +
geom_col(show.legend = FALSE) +
scale_x_continuous(labels = percent) +
scale_fill_manual(values = c("gray75", "#3C3B6E")) +
theme(plot.title = element_markdown(lineheight = 1.1)) +
scale_y_reordered() +
facet_wrap(~issue, scale = "free_y") +
labs(x = "% 'YES' votes",
y = "",
title = "**10 UN Countries with the lowest percentage of 'YES' votes by issue**<br>
<span style='font-size:12pt'>The <span style='color:#3C3B6E;'>**United States**</span> has the lowest percentage of 'YES' votes in 4 out of the 6 issues</span>",
caption = "Source: Harvard Dataverse  |  Analysis: Tony Galvan (@GDataScience1)")
# This will save your most recent plot
ggsave(
filename = "2021_03_23_tidy_tuesday.png",
device = "png")
# This will save your most recent plot
ggsave(
filename = "2021_03_23_tidy_tuesday.png",
width = 10
device = "png")
# This will save your most recent plot
ggsave(
filename = "2021_03_23_tidy_tuesday.png",
width = 10,
device = "png")
un_votes %>%
filter(!is.na(issue)) %>%
group_by(country, issue) %>%
summarize(n = n(),
vote_yes = sum(ifelse(vote == "yes", 1, 0)),
pct_yes_vote = vote_yes / n) %>%
ungroup() %>%
filter(n >= 250) %>%
group_by(issue) %>%
top_n(10, wt = -pct_yes_vote) %>%
ungroup() %>%
mutate(fill = ifelse(country == "United States", "US", "Other"),
country = reorder_within(country, -pct_yes_vote, issue)) %>%
ggplot(aes(pct_yes_vote, country, fill = fill)) +
geom_col(show.legend = FALSE) +
scale_x_continuous(labels = percent) +
scale_fill_manual(values = c("gray75", "#3C3B6E")) +
theme(plot.title = element_markdown(lineheight = 1.1)) +
scale_y_reordered() +
facet_wrap(~issue, scale = "free_y") +
labs(x = "% 'YES' votes",
y = "",
title = "**10 UN Countries with the lowest percentage of 'YES' votes by issue**<br>
<span style='font-size:12pt'>The <span style='color:#3C3B6E;'>**United States**</span> has the lowest in 4 out of the 6 issues</span>",
caption = "Source: Harvard Dataverse  |  Analysis: Tony Galvan (@GDataScience1)")
un_votes %>%
filter(!is.na(issue)) %>%
group_by(country, issue) %>%
summarize(n = n(),
vote_yes = sum(ifelse(vote == "yes", 1, 0)),
pct_yes_vote = vote_yes / n) %>%
ungroup() %>%
filter(n >= 250) %>%
group_by(issue) %>%
top_n(10, wt = -pct_yes_vote) %>%
ungroup() %>%
mutate(fill = ifelse(country == "United States", "US", "Other"),
country = reorder_within(country, -pct_yes_vote, issue)) %>%
ggplot(aes(pct_yes_vote, country, fill = fill)) +
geom_col(show.legend = FALSE) +
scale_x_continuous(labels = percent) +
scale_fill_manual(values = c("gray75", "#3C3B6E")) +
theme(plot.title = element_markdown(lineheight = 1.1)) +
scale_y_reordered() +
facet_wrap(~issue, scale = "free_y") +
labs(x = "% 'YES' votes",
y = "",
title = "**10 UN Countries with the lowest percentage of 'YES' votes by issue**<br>
<span style='font-size:12pt'>The <span style='color:#3C3B6E;'>**United States**</span> has the lowest in 4 out of the 6 issues</span>",
caption = "Source: Harvard Dataverse  |  Analysis: Tony Galvan (@GDataScience1)")
# This will save your most recent plot
ggsave(
filename = "2021_03_23_tidy_tuesday.png",
width = 10,
device = "png")
